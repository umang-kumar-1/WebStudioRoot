--- /Users/smalsus/Desktop/Web Studio Root /WebStudioPreview/src/store.ts	2026-02-06 12:11:42
+++ /Users/smalsus/Desktop/Web Studio Root /Web Studio/src/webparts/webStudio/store.ts	2026-02-16 18:43:32
@@ -1,45 +1,115 @@
 
-
 import { create } from 'zustand';
-import { persist, createJSONStorage } from 'zustand/middleware';
-import { ModalType, ViewMode, ContainerType } from './types';
-import type { Page, SiteConfig, ThemeConfig, LanguageCode, MultilingualText, NavItem, NewsItem, EventItem, DocumentItem, Container, ImageItem, ImageFolder, TranslationItem, PermissionGroup, PermissionUser, ContactQuery } from './types';
+import { ModalType, ViewMode, Page, SiteConfig, ThemeConfig, LanguageCode, MultilingualText, NavItem, NewsItem, EventItem, DocumentItem, Container, ContainerItem, ContactItem, ImageItem, ImageFolder, TranslationItem, PermissionGroup, PermissionUser, ContactQuery } from './types';
 
-
-// Static UI Translations (Initial State)
+// Initial State for UI Labels (populated from SharePoint)
 export const INITIAL_UI_LABELS: Record<string, MultilingualText> = {
-  // App Header
   APP_TITLE: { en: 'Web Studio', de: 'Web Studio', fr: 'Web Studio', es: 'Web Studio' },
   APP_SUBTITLE: { en: 'Enterprise CMS', de: 'Unternehmens-CMS', fr: 'CMS d\'entreprise', es: 'CMS empresarial' },
-
-  // Sidebar Sections
   SITE_GLOBALS: { en: 'Site Globals', de: 'Globale Einstellungen', fr: 'Paramètres globaux', es: 'Configuración global' },
   PAGES: { en: 'Pages', de: 'Seiten', fr: 'Pages', es: 'Páginas' },
   SECTION_PAGE_INFO: { en: 'Page Info', de: 'Seiteninfo', fr: 'Info page', es: 'Info página' },
-
-  // Page Info Labels
   LABEL_TITLE: { en: 'Title', de: 'Titel', fr: 'Titre', es: 'Título' },
   LABEL_STATUS: { en: 'Status', de: 'Status', fr: 'Statut', es: 'Estado' },
   LABEL_MODIFIED: { en: 'Modified', de: 'Geändert', fr: 'Modifié', es: 'Modificado' },
-
-  // Toggle Buttons
   PAGE_PREVIEW: { en: 'Page Preview', de: 'Seitenvorschau', fr: 'Aperçu de la page', es: 'Vista previa' },
   EDIT_MODE: { en: 'Edit Mode', de: 'Bearbeitungsmodus', fr: 'Mode édition', es: 'Modo edición' },
-
-  // Management Items
+  CONTENT_TRANS: { en: 'Content Translator', de: 'Inhaltsübersetzer', fr: 'Traducteur de contenu', es: 'Traductor de contenido' },
   NAV_MGMT: { en: 'Navigation Management', de: 'Navigationsverwaltung', fr: 'Gestion de navigation', es: 'Gestión de navegación' },
   NEWS_MGMT: { en: 'News Management', de: 'Nachrichtenverwaltung', fr: 'Gestion des actualités', es: 'Gestión de noticias' },
   EVENT_MGMT: { en: 'Event Management', de: 'Veranstaltungsverwaltung', fr: 'Gestion des événements', es: 'Gestión de eventos' },
   DOC_MGMT: { en: 'Document Management', de: 'Dokumentenverwaltung', fr: 'Gestion documentaire', es: 'Gestión de documentos' },
   FOOTER_MGMT: { en: 'Footer Management', de: 'Fußzeilenverwaltung', fr: 'Gestion de pied de page', es: 'Gestión de pie de página' },
   SITE_MGMT: { en: 'Site Management', de: 'Seitenverwaltung', fr: 'Gestion du site', es: 'Gestión del sitio' },
-  IMG_MGMT: { en: 'Image Management', de: 'Bildverwaltung', fr: 'Gestion des images', es: 'Gestión de imágenes' },
-  CONTENT_TRANS: { en: 'Content Translator', de: 'Inhaltsübersetzer', fr: 'Traducteur de contenu', es: 'Traductor de contenu' },
+  IMG_MGMT: { en: 'Image Management', de: 'Bildverwaltung', fr: 'Gestion des images', es: 'Gestion des images' },
   PERM_MGMT: { en: 'Permission Management', de: 'Berechtigungsverwaltung', fr: 'Gestion des permissions', es: 'Gestión de permisos' },
   CONTACT_Q: { en: 'Contact Form Queries', de: 'Kontaktanfragen', fr: 'Demandes de contact', es: 'Consultas de contacto' },
   STYLING: { en: 'Styling Configuration', de: 'Design-Konfiguration', fr: 'Configuration du style', es: 'Configuración de estilo' },
+  BTN_EDIT: { en: 'Edit', de: 'Bearbeiten', fr: 'Éditer', es: 'Editar' },
+  LABEL_ORIGINAL: { en: 'Original', de: 'Original', fr: 'Original', es: 'Original' },
+  LABEL_TRANSLATION: { en: 'Translation', de: 'Übersetzung', fr: 'Traduction', es: 'Traducción' },
+  LABEL_TRANSLATED: { en: 'Translated', de: 'Übersetzt', fr: 'Traduit', es: 'Traducido' },
+  BTN_SUGGEST_AI: { en: 'Suggest with AI', de: 'Mit KI vorschlagen', fr: 'Suggérer avec IA', es: 'Sugerir con IA' },
+  TITLE_EDIT_TRANSLATION: { en: 'Edit Translation', de: 'Übersetzung bearbeiten', fr: 'Modifier la traduction', es: 'Editar traducción' },
+  CONTAINER_ITEM_MGMT: { en: 'Container Items', de: 'Container-Elemente', fr: 'Éléments de conteneur', es: 'elementos de contenedor' },
+  TITLE_CREATE_CONTAINER_ITEM: { en: 'Create Container Item', de: 'Container-Element erstellen', fr: 'Créer un élément de conteneur', es: 'Crear elemento de contenedor' },
+  PLACEHOLDER_ITEM_TITLE: { en: 'Enter item title...', de: 'Titel des Elements eingeben...', fr: 'Entrez le titre de l\'élément...', es: 'Ingrese el título del elemento...' },
+  TITLE_EDIT_CONTAINER_ITEM: { en: 'Edit Container Item', de: 'Container-Element bearbeiten', fr: 'Modifier l\'élément de conteneur', es: 'Editar elemento de contenedor' },
+  TAB_BASIC_INFO: { en: 'Basic Info', de: 'Basis-Info', fr: 'Infos de base', es: 'Información básica' },
+  TAB_IMAGE_INFO: { en: 'Image Info', de: 'Bild-Info', fr: 'Infos image', es: 'Información de imagen' },
+  TAB_SEO: { en: 'SEO', de: 'SEO', fr: 'SEO', es: 'SEO' },
+  TAB_TRANSLATION: { en: 'Translation', de: 'Übersetzung', fr: 'Traduction', es: 'Traducción' },
+  LABEL_SORT_ORDER: { en: 'Sort Order', de: 'Sortierung', fr: 'Ordre de tri', es: 'Orden de clasificación' },
+  LABEL_ADD_READ_MORE: { en: 'Add Read More Link', de: 'Mehr lesen Link hinzufügen', fr: 'Ajouter un lien Lire la suite', es: 'Agregar enlace Leer más' },
+  LABEL_LINK_URL: { en: 'Link URL', de: 'Link URL', fr: 'URL du lien', es: 'URL del enlace' },
+  LABEL_LINK_TEXT: { en: 'Link Text', de: 'Link Text', fr: 'Texte du lien', es: 'Texto del enlace' },
+  LABEL_ORIGINAL_DESC: { en: 'Original Description', de: 'Originale Beschreibung', fr: 'Description originale', es: 'Descripción original' },
+  PLACEHOLDER_ITEM_DESC: { en: 'Enter item description...', de: 'Beschreibung des Elements eingeben...', fr: 'Entrez la description de l\'élément...', es: 'Ingrese la descripción del elemento...' },
+  LABEL_SEO_TITLE: { en: 'SEO Title', de: 'SEO Titel', fr: 'Titre SEO', es: 'Título SEO' },
+  LABEL_META_DESC: { en: 'Meta Description', de: 'Meta-Beschreibung', fr: 'Méta description', es: 'Meta descripción' },
+  LABEL_KEYWORDS: { en: 'Keywords', de: 'Schlagworte', fr: 'Mots-clés', es: 'Palabras clave' },
+  LABEL_TRANSLATED_TITLE: { en: 'Translated Title', de: 'Übersetzter Titel', fr: 'Titre traduit', es: 'Título traducido' },
+  LABEL_TRANSLATED_READ_MORE: { en: 'Translated Link Text', de: 'Übersetzter Link-Text', fr: 'Texte de lien traduit', es: 'Texto de enlace traducido' },
+  LABEL_TRANSLATED_DESC: { en: 'Translated Description', de: 'Übersetzte Beschreibung', fr: 'Description traduite', es: 'Descripción traducida' },
+  BTN_ADD_ITEM: { en: 'Add Item', de: 'Element hinzufügen', fr: 'Ajouter un élément', es: 'Agregar elemento' },
+  LABEL_SEARCH_ITEMS: { en: 'Search items...', de: 'Elemente suchen...', fr: 'Rechercher des éléments...', es: 'Buscar elementos...' },
+  MSG_CONTAINER_ITEM_DESC: { en: 'Manage reusable items for your containers.', de: 'Verwalten Sie wiederverwendbare Elemente für Ihre Container.', fr: 'Gérez les éléments réutilisables pour vos conteneurs.', es: 'Administre elementos reutilizables para sus contenedores.' },
+
+  // Contact Management
+  CONTACT_MGMT: { en: 'Contact Management', de: 'Kontaktverwaltung', fr: 'Gestion des contacts', es: 'Gestión de contactos' },
+  TITLE_CREATE_CONTACT: { en: 'Create New Contact', de: 'Neuen Kontakt erstellen', fr: 'Créer un nouveau contact', es: 'Crear nuevo contacto' },
+  TITLE_EDIT_CONTACT: { en: 'Edit Contact', de: 'Kontakt bearbeiten', fr: 'Modifier le contact', es: 'Editar contacto' },
+  LABEL_FIRST_NAME: { en: 'First Name', de: 'Vorname', fr: 'Prénom', es: 'Nombre' },
+  LABEL_LAST_NAME: { en: 'Last Name', de: 'Nachname', fr: 'Nom de famille', es: 'Apellido' },
+  LABEL_FULL_NAME: { en: 'Full Name', de: 'Vollständiger Name', fr: 'Nom complet', es: 'Nombre completo' },
+  LABEL_JOB_TITLE: { en: 'Job Title', de: 'Berufsbezeichnung', fr: 'Titre du poste', es: 'Título del trabajo' },
+  LABEL_COMPANY: { en: 'Company', de: 'Firma', fr: 'Entreprise', es: 'Empresa' },
+  LABEL_EMAIL: { en: 'Email', de: 'E-Mail', fr: 'E-mail', es: 'Correo electrónico' },
+  LABEL_PHONE: { en: 'Phone', de: 'Telefon', fr: 'Téléphone', es: 'Teléfono' },
+  TAB_SOCIAL_LINKS: { en: 'Social Links', de: 'Soziale Medien', fr: 'Réseaux sociaux', es: 'Redes sociales' },
+  LABEL_LINKEDIN: { en: 'LinkedIn URL', de: 'LinkedIn URL', fr: 'URL LinkedIn', es: 'URL de LinkedIn' },
+  LABEL_TWITTER: { en: 'Twitter URL', de: 'Twitter URL', fr: 'URL Twitter', es: 'URL de Twitter' },
+  LABEL_FACEBOOK: { en: 'Facebook URL', de: 'Facebook URL', fr: 'URL Facebook', es: 'URL de Facebook' },
+  PLACEHOLDER_CONTACT_NAME: { en: 'Enter contact name...', de: 'Kontaktname eingeben...', fr: 'Entrez le nom du contact...', es: 'Ingrese el nombre del contacto...' },
+  MSG_CONTACT_DESC: { en: 'Manage your team members and contacts.', de: 'Verwalten Sie Ihre Teammitglieder und Kontakte.', fr: 'Gérez vos membres d\'équipe et vos contacts.', es: 'Administre los miembros de su equipo y contactos.' },
+
+  // General Buttons & Labels
+  BTN_CREATE: { en: 'Create', de: 'Erstellen', fr: 'Créer', es: 'Crear' },
+  BTN_CANCEL: { en: 'Cancel', de: 'Abbrechen', fr: 'Annuler', es: 'Cancelar' },
+  BTN_SAVE: { en: 'Save', de: 'Speichern', fr: 'Enregistrer', es: 'Guardar' },
+  BTN_DELETE: { en: 'Delete', de: 'Löschen', fr: 'Supprimer', es: 'Eliminar' },
+  BTN_REMOVE: { en: 'Remove', de: 'Entfernen', fr: 'Retirer', es: 'Eliminar' },
+  LABEL_DESCRIPTION: { en: 'Description', de: 'Beschreibung', fr: 'Description', es: 'Descripción' },
+  LABEL_ACTIONS: { en: 'Actions', de: 'Aktionen', fr: 'Actions', es: 'Acciones' },
+  TAB_IMAGE: { en: 'Image Information', de: 'Bild', fr: 'Image', es: 'Imagen' },
+
+  // Image Upload Messages
+  MSG_PASTE_OR_UPLOAD: { en: 'Paste image or click to upload', de: 'Bild einfügen oder zum Hochladen klicken', fr: 'Collez une image ou cliquez pour télécharger', es: 'Pegue la imagen o haga clic para cargar' },
+  MSG_SUPPORTS_IMAGE_FORMATS: { en: 'Supports JPG, PNG, WEBP', de: 'Unterstützt JPG, PNG, WEBP', fr: 'Supporte JPG, PNG, WEBP', es: 'Soporta JPG, PNG, WEBP' },
+  MSG_UPLOADING: { en: 'Uploading...', de: 'Wird hochgeladen...', fr: 'Téléchargement...', es: 'Subiendo...' },
+  LABEL_CHOOSE_FROM_GALLERY: { en: 'Choose from Gallery', de: 'Aus Galerie wählen', fr: 'Choisir dans la galerie', es: 'Elegir de la galería' },
+
+  // Translation Info
+  MSG_TRANSLATION_INFO: { en: 'Provide translations for multilingual support. Fallback to English if empty.', de: 'Geben Sie Übersetzungen für mehrsprachige Unterstützung an. Fallback auf Englisch, wenn leer.', fr: 'Fournissez des traductions pour le support multilingue. Retour à l\'anglais si vide.', es: 'Proporcione traducciones para soporte multilingüe. Vuelve a inglés si está vacío.' },
+
+  // Missing Labels for Contact Manager & others
+  BTN_CLOSE: { en: 'Close', de: 'Schließen', fr: 'Fermer', es: 'Cerrar' },
+  LABEL_VISUAL_VIEW: { en: 'Visual View', de: 'Visuelle Ansicht', fr: 'Vue visuelle', es: 'Vista visual' },
+  LABEL_LIST_VIEW: { en: 'List View', de: 'Listenansicht', fr: 'Vue liste', es: 'Vista de lista' },
+  LABEL_SEARCH_CONTACTS: { en: 'Search contacts...', de: 'Kontakte suchen...', fr: 'Rechercher des contacts...', es: 'Buscar contactos...' },
+  LABEL_SORT_BY: { en: 'Sort by', de: 'Sortieren nach', fr: 'Trier par', es: 'Ordenar por' },
+  BTN_ADD_CONTACT: { en: 'Add Contact', de: 'Kontakt hinzufügen', fr: 'Ajouter un contact', es: 'Agregar contacto' },
+  MSG_REQ_TITLE: { en: 'This field is required.', de: 'Dieses Feld ist erforderlich.', fr: 'Ce champ est obligatoire.', es: 'Este campo es obligatorio.' },
+  LABEL_IMAGE_URL: { en: 'Image URL', de: 'Bild URL', fr: 'URL de l\'image', es: 'URL de la imagen' },
+  LABEL_IMAGE_NAME: { en: 'Image Name', de: 'Bildname', fr: 'Nom de l\'image', es: 'Nombre de la imagen' },
+  LABEL_TRANSLATED_JOB_TITLE: { en: 'Translated Job Title', de: 'Übersetzter Beruf', fr: 'Titre du poste traduit', es: 'Título del trabajo traducido' },
+  LABEL_OPEN_OOTB_FORM: { en: 'Open out-of-the-box form', de: 'Standard-Formular öffnen', fr: 'Ouvrir le formulaire standard', es: 'Abrir formulario estándar' },
+  TAB_URL: { en: 'URL', de: 'URL', fr: 'URL', es: 'URL' },
+  BTN_DEFAULT_LOGO: { en: 'Default Logo', de: 'Standardlogo', fr: 'Logo par défaut', es: 'Logo predeterminado' },
 };
 
+export const GLOBAL_DEFAULT_IMAGE = 'https://hochhuth-consulting.de//images/logo.png';
+
 export const DEFAULT_THEME: ThemeConfig = {
   // Brand Colors (Corporate Blue #2f5596)
   '--primary-color': '#2f5596',
@@ -117,532 +187,23 @@
   '--font-size-h5': '16px',
   '--font-size-h6': '14px',
   '--font-weight-bold': '600',
-};
 
-// Helper: Generate Default Containers - PAGE-WISE ISOLATION
-const createDefaultContainers = (pageId: string): Container[] => {
-  // --- PAGE 1: HOME ---
-  if (pageId === '1') {
-    return [
-      {
-        id: `c_home_slider`,
-        pageId: pageId,
-        type: ContainerType.SLIDER,
-        order: 0,
-        isVisible: true,
-        settings: { templateId: 'img_text', speed: 5, autoplay: true },
-        content: { title: { en: 'Welcome to Web Studio', de: 'Willkommen', fr: 'Bienvenue', es: 'Bienvenido' } }
-      },
-      {
-        id: `c_home_news_grid`,
-        pageId: pageId,
-        type: ContainerType.CARD_GRID,
-        order: 1,
-        isVisible: true,
-        settings: {
-          source: 'News',
-          columns: 3,
-          ordering: '123',
-          layout: 'grid',
-          imgPos: 'top',
-          border: 'sharp',
-          title: 'Latest News',
-          taggedItems: ['1', 'mock_1', 'mock_2']
-        },
-        content: { title: { en: 'Latest News', de: 'Aktuelle Nachrichten', fr: 'Dernières nouvelles', es: 'Últimas noticias' } }
-      },
-      {
-        id: `c_home_events`,
-        pageId: pageId,
-        type: ContainerType.CARD_GRID,
-        order: 2,
-        isVisible: true,
-        settings: {
-          source: 'Event',
-          columns: 3,
-          ordering: 'none',
-          layout: 'slider',
-          imgPos: 'left',
-          border: 'rounded',
-          title: 'Upcoming Events',
-          taggedItems: ['e1', 'mock_e1', 'mock_e2']
-        },
-        content: { title: { en: 'Upcoming Events', de: 'Kommende Veranstaltungen', fr: 'Événements à venir', es: 'Próximos eventos' } }
-      }
-    ];
-  }
-
-  // --- PAGE 2: WHAT WE OFFER ---
-  if (pageId === '2') {
-    return [
-      {
-        id: `c_offer_hero`,
-        pageId: pageId,
-        type: ContainerType.HERO,
-        order: 0,
-        isVisible: true,
-        settings: {
-          templateId: 'hero_img',
-          templateVariant: 1,
-          bgType: 'image',
-          bgImage: 'https://images.unsplash.com/photo-1519389950473-47ba0277781c?auto=format&fit=crop&w=2000&q=80',
-          bgColor: '#1c355f',
-          titleColor: 'white',
-          align: 'center',
-          heading: 'Our Services',
-          containerTitle: 'What We Offer'
-        },
-        content: {
-          title: { en: 'World Class Solutions', de: 'Weltklasse-Lösungen', fr: 'Solutions de classe mondiale', es: 'Soluciones de clase mundial' },
-          subtitle: { en: 'Tailored for your business needs', de: 'Maßgeschneidert für Ihre Bedürfnisse', fr: 'Adapté à vos besoins', es: 'Adaptado a sus necesidades' },
-          description: { en: 'We provide a wide range of digital services including consulting, development, and support.', de: 'Wir bieten eine breite Palette digitaler Dienste an.', fr: 'Nous proposons une large gamme de services numériques.', es: 'Ofrecemos una amplia gama de servicios digitales.' }
-        }
-      },
-      {
-        id: `c_offer_docs`,
-        pageId: pageId,
-        type: ContainerType.CARD_GRID,
-        order: 1,
-        isVisible: true,
-        settings: {
-          source: 'Document',
-          columns: 3,
-          ordering: 'ABC',
-          layout: 'grid',
-          imgPos: 'none',
-          border: 'sharp',
-          title: 'Service Catalog',
-          taggedItems: ['d1', 'm1', 'm8']
-        },
-        content: { title: { en: 'Service Catalog', de: 'Servicekatalog', fr: 'Catalogue de services', es: 'Catálogo de servicios' } }
-      },
-      {
-        id: `c_offer_slider`,
-        pageId: pageId,
-        type: ContainerType.SLIDER,
-        order: 2,
-        isVisible: true,
-        settings: {
-          templateId: 'img_gallery',
-          templateVariant: 1,
-          speed: 4,
-          autoplay: true,
-          slides: [
-            { id: 's_prod1', title: 'Product A', desc: 'High performance module', image: 'https://images.unsplash.com/photo-1551288049-bebda4e38f71?auto=format&fit=crop&w=1600&q=80' },
-            { id: 's_prod2', title: 'Product B', desc: 'Enterprise integration', image: 'https://images.unsplash.com/photo-1518770660439-4636190af475?auto=format&fit=crop&w=1600&q=80' }
-          ]
-        },
-        content: { title: { en: 'Product Gallery', de: 'Produktgalerie', fr: 'Galerie de produits', es: 'Galería de productos' } }
-      }
-    ];
-  }
-
-  // --- PAGE 3: HOW WE WORK ---
-  if (pageId === '3') {
-    return [
-      {
-        id: `c_work_hero`,
-        pageId: pageId,
-        type: ContainerType.HERO,
-        order: 0,
-        isVisible: true,
-        settings: {
-          templateId: 'visual_text',
-          templateVariant: 2,
-          bgType: 'layout',
-          layoutVariant: 'img_right',
-          bgImage: 'https://images.unsplash.com/photo-1522071820081-009f0129c71c?auto=format&fit=crop&w=2000&q=80',
-          bgColor: '#f8fafc',
-          titleColor: 'black',
-          align: 'left',
-          heading: 'Our Process',
-          containerTitle: 'Methodology'
-        },
-        content: {
-          title: { en: 'Agile & Efficient', de: 'Agil & Effizient', fr: 'Agile et Efficace', es: 'Ágil y Eficiente' },
-          description: { en: 'We follow a strict agile methodology to ensure rapid delivery and continuous improvement.', de: 'Wir folgen einer strengen agilen Methodik.', fr: 'Nous suivons une méthodologie agile stricte.', es: 'Seguimos una metodología ágil estricta.' }
-        }
-      },
-      {
-        id: `c_work_table`,
-        pageId: pageId,
-        type: ContainerType.TABLE,
-        order: 1,
-        isVisible: true,
-        settings: {
-          title: 'Project Phases',
-          columns: [
-            { id: 'c1', header: 'Phase' },
-            { id: 'c2', header: 'Duration' },
-            { id: 'c3', header: 'Deliverables' }
-          ],
-          enableGlobalSearch: false,
-          enableSorting: true
-        },
-        content: {
-          title: { en: 'Project Phases', de: 'Projektphasen', fr: 'Phases du projet', es: 'Fases del proyecto' },
-          rows: [
-            { id: 'r1', c1: 'Discovery', c2: '2 Weeks', c3: 'Requirements Doc' },
-            { id: 'r2', c1: 'Design', c2: '4 Weeks', c3: 'Figma Prototypes' },
-            { id: 'r3', c1: 'Development', c2: '8 Weeks', c3: 'Production Code' }
-          ]
-        }
-      },
-      {
-        id: `c_work_map`,
-        pageId: pageId,
-        type: ContainerType.MAP,
-        order: 2,
-        isVisible: true,
-        settings: {
-          title: 'Global Presence',
-          mapType: 'World',
-          locationSearch: 'Berlin, Germany'
-        },
-        content: { title: { en: 'Our Locations', de: 'Unsere Standorte', fr: 'Nos emplacements', es: 'Nuestras ubicaciones' } }
-      }
-    ];
-  }
-
-  // --- PAGE 4: WHO WE ARE (Matches previous specific requirement) ---
-  if (pageId === '4') {
-    return [
-      {
-        id: `c_who_hero`,
-        pageId: pageId,
-        type: ContainerType.HERO,
-        order: 0,
-        isVisible: true,
-        settings: {
-          templateId: 'visual_text',
-          templateVariant: 1,
-          minHeight: 'full',
-          bgType: 'image',
-          bgImage: 'https://images.unsplash.com/photo-1464822759023-fed622ff2c3b?auto=format&fit=crop&w=2000&q=80',
-          bgColor: '#ffffff',
-          titleColor: 'white',
-          align: 'center',
-          heading: 'WHO WE ARE',
-          containerTitle: 'About Us'
-        },
-        content: {
-          title: { en: 'WHO WE ARE', de: 'WER WIR SIND', fr: 'QUI NOUS SOMMES', es: 'QUIÉNES SOMOS' },
-          subtitle: { en: 'Driving Innovation & Excellence', de: 'Innovation und Exzellenz vorantreiben', fr: 'Stimuler l\'innovation et l\'excellence', es: 'Impulsando la innovación y la excelencia' },
-          description: { en: 'We are a dedicated team of professionals committed to delivering high-quality solutions that empower businesses to thrive in the digital age.', de: 'Wir sind ein engagiertes Team von Fachleuten.', fr: 'Nous sommes une équipe dévouée.', es: 'Somos un equipo dedicado.' }
-        }
-      },
-      {
-        id: `c_who_events`,
-        pageId: pageId,
-        type: ContainerType.CARD_GRID,
-        order: 1,
-        isVisible: true,
-        settings: {
-          source: 'Event',
-          columns: 3,
-          ordering: 'none',
-          layout: 'grid',
-          imgPos: 'top',
-          border: 'sharp',
-          title: 'Upcoming Events',
-          taggedItems: ['e1', 'mock_e1', 'mock_e2']
-        },
-        content: {
-          title: { en: 'Upcoming Events', de: 'Kommende Veranstaltungen', fr: 'Événements à venir', es: 'Próximos Eventos' }
-        }
-      },
-      {
-        id: `c_who_gallery`,
-        pageId: pageId,
-        type: ContainerType.SLIDER,
-        order: 2,
-        isVisible: true,
-        settings: {
-          templateId: 'img_gallery',
-          templateVariant: 1,
-          speed: 5,
-          autoplay: true,
-          arrows: true,
-          dots: true,
-          slides: [
-            {
-              id: 's1',
-              title: 'Our Office',
-              sub: 'Berlin Headquarters',
-              desc: 'A glimpse into our daily work environment.',
-              image: 'https://images.unsplash.com/photo-1497366216548-37526070297c?auto=format&fit=crop&w=1600&q=80'
-            },
-            {
-              id: 's2',
-              title: 'Team Spirit',
-              sub: 'Collaborative Culture',
-              desc: 'We believe in the power of teamwork.',
-              image: 'https://images.unsplash.com/photo-1556761175-5973dc0f32e7?auto=format&fit=crop&w=1600&q=80'
-            },
-            {
-              id: 's3',
-              title: 'Global Impact',
-              sub: 'Connecting the World',
-              desc: 'Our solutions reach clients globally.',
-              image: 'https://images.unsplash.com/photo-1522071820081-009f0129c71c?auto=format&fit=crop&w=1600&q=80'
-            }
-          ]
-        },
-        content: {
-          title: { en: 'Our Gallery', de: 'Unsere Galerie', fr: 'Notre Galerie', es: 'Nuestra Galería' }
-        }
-      }
-    ];
-  }
-
-  // --- PAGE 5: CAREERS ---
-  if (pageId === '5') {
-    return [
-      {
-        id: `c_career_hero`,
-        pageId: pageId,
-        type: ContainerType.HERO,
-        order: 0,
-        isVisible: true,
-        settings: {
-          templateId: 'hero_img',
-          bgType: 'image',
-          bgImage: 'https://images.unsplash.com/photo-1521737711867-e3b97375f902?auto=format&fit=crop&w=2000&q=80',
-          titleColor: 'white',
-          align: 'center',
-          heading: 'Join Our Team',
-          containerTitle: 'Careers'
-        },
-        content: {
-          title: { en: 'Build the Future With Us', de: 'Bauen Sie die Zukunft mit uns', fr: 'Construisez l\'avenir avec nous', es: 'Construye el futuro con nosotros' },
-          description: { en: 'Explore exciting opportunities to grow your career.', de: 'Entdecken Sie spannende Möglichkeiten.', fr: 'Explorez des opportunités passionnantes.', es: 'Explora oportunidades emocionantes.' }
-        }
-      },
-      {
-        id: `c_career_jobs`,
-        pageId: pageId,
-        type: ContainerType.CARD_GRID,
-        order: 1,
-        isVisible: true,
-        settings: {
-          source: 'News', // Mocking Jobs via News items for now
-          columns: 2,
-          ordering: 'none',
-          layout: 'grid',
-          imgPos: 'left',
-          border: 'sharp',
-          title: 'Open Positions',
-          taggedItems: ['mock_6', 'mock_10']
-        },
-        content: { title: { en: 'Open Positions', de: 'Offene Stellen', fr: 'Postes ouverts', es: 'Posiciones abiertas' } }
-      },
-      {
-        id: `c_career_contact`,
-        pageId: pageId,
-        type: ContainerType.CONTACT_FORM,
-        order: 2,
-        isVisible: true,
-        settings: {
-          heading: 'Apply Now',
-          subheading: 'Send us your resume',
-          bgType: 'color',
-          bgColor: '#f3f4f6',
-          buttonText: 'Submit Application',
-          fields: [
-            { id: 'f1', label: 'Full Name', type: 'text', required: true },
-            { id: 'f2', label: 'Email', type: 'email', required: true },
-            { id: 'f3', label: 'LinkedIn Profile', type: 'text', required: false },
-            { id: 'f4', label: 'Cover Letter', type: 'textarea', required: true }
-          ]
-        },
-        content: { title: { en: 'Apply Now', de: 'Jetzt bewerben', fr: 'Postuler maintenant', es: 'Aplica ya' } }
-      }
-    ];
-  }
-
-  // --- PAGE 6: CONTACT ---
-  if (pageId === '6') {
-    return [
-      {
-        id: `c_contact_hero`,
-        pageId: pageId,
-        type: ContainerType.HERO,
-        order: 0,
-        isVisible: true,
-        settings: {
-          templateId: 'page_content',
-          bgType: 'color',
-          bgColor: '#1f2937',
-          titleColor: 'white',
-          align: 'center',
-          heading: 'Contact Us',
-          containerTitle: 'Get in Touch'
-        },
-        content: {
-          title: { en: 'We are here to help', de: 'Wir sind hier um zu helfen', fr: 'Nous sommes là pour aider', es: 'Estamos aquí para ayudar' },
-          description: { en: 'Reach out to us for any inquiries or support.', de: 'Kontaktieren Sie uns für Anfragen.', fr: 'Contactez-nous pour toute demande.', es: 'Contáctenos para cualquier consulta.' }
-        }
-      },
-      {
-        id: `c_contact_form`,
-        pageId: pageId,
-        type: ContainerType.CONTACT_FORM,
-        order: 1,
-        isVisible: true,
-        settings: {
-          heading: 'Send a Message',
-          bgType: 'none',
-          fields: [
-            { id: 'c1', label: 'Name', type: 'text', required: true },
-            { id: 'c2', label: 'Email', type: 'email', required: true },
-            { id: 'c3', label: 'Subject', type: 'text', required: false },
-            { id: 'c4', label: 'Message', type: 'textarea', required: true }
-          ],
-          buttonText: 'Send Message'
-        },
-        content: { title: { en: 'Contact Form', de: 'Kontaktformular', fr: 'Formulaire de contact', es: 'Formulario de contacto' } }
-      },
-      {
-        id: `c_contact_map`,
-        pageId: pageId,
-        type: ContainerType.MAP,
-        order: 2,
-        isVisible: true,
-        settings: {
-          title: 'Visit Us',
-          mapType: 'Country',
-          selectedRegion: 'Germany',
-          locationSearch: 'Munich'
-        },
-        content: { title: { en: 'Headquarters', de: 'Hauptquartier', fr: 'Siège social', es: 'Sede central' } }
-      }
-    ];
-  }
-
-  return [];
+  // Icon Styling
+  '--icon-color': '#2f5596',
+  '--edit-icon-bg': '#2563eb',
+  '--edit-icon-color': '#ffffff',
+  '--edit-icon-hover-bg': '#1d4ed8',
 };
 
-const MOCK_NAV: NavItem[] = [
-  { id: '1', parentId: 'root', title: 'HOME', type: 'Page', pageId: '1', isVisible: true, openInNewTab: false, order: 0 },
-  { id: '2', parentId: 'root', title: 'WHAT WE OFFER', type: 'Page', pageId: '2', isVisible: true, openInNewTab: false, order: 1 },
-  { id: '3', parentId: 'root', title: 'HOW WE WORK', type: 'Page', pageId: '3', isVisible: true, openInNewTab: false, order: 2 },
-  { id: '3_1', parentId: '3', title: 'Our Process', type: 'Page', pageId: '1', isVisible: true, openInNewTab: false, order: 0 },
-  { id: '4', parentId: 'root', title: 'WHO WE ARE', type: 'Page', pageId: '4', isVisible: true, openInNewTab: false, order: 3 },
-  { id: '5', parentId: 'root', title: 'CAREERS', type: 'Page', pageId: '5', isVisible: true, openInNewTab: false, order: 4 },
-  { id: '6', parentId: 'root', title: 'CONTACT', type: 'Page', pageId: '6', isVisible: true, openInNewTab: false, order: 5 },
-];
 
-const MOCK_PAGES: Page[] = [
-  {
-    id: '1',
-    title: { en: 'Home', de: 'Startseite', fr: 'Accueil', es: 'Inicio' },
-    slug: '/',
-    status: 'Published',
-    createdBy: 'Sameer Gupta',
-    modifiedBy: 'Shivdutt Mishra',
-    modifiedDate: '2026-02-03T12:45:00Z',
-    description: 'Welcome to our corporate intranet home page. This is the central hub for all company news.',
-    isHomePage: true,
-    seo: { title: 'Home - Web Studio', description: 'Corporate Intranet Home', keywords: 'home, intranet, corporate, news' },
-    containers: createDefaultContainers('1')
-  },
-  {
-    id: '2',
-    title: { en: 'What We Offer', de: 'Was wir bieten', fr: 'Ce que nous offrons', es: 'Lo que ofrecemos' },
-    slug: '/what-we-offer',
-    status: 'Published',
-    createdBy: 'System',
-    modifiedBy: 'Admin',
-    modifiedDate: new Date().toISOString(),
-    description: 'Overview of our services and products.',
-    seo: { title: 'Services - Web Studio', description: 'Our offerings', keywords: 'services, products' },
-    containers: createDefaultContainers('2')
-  },
-  {
-    id: '3',
-    title: { en: 'How We Work', de: 'Wie wir arbeiten', fr: 'Notre méthode', es: 'Cómo trabajamos' },
-    slug: '/how-we-work',
-    status: 'Published',
-    createdBy: 'System',
-    modifiedBy: 'Admin',
-    modifiedDate: new Date().toISOString(),
-    containers: createDefaultContainers('3')
-  },
-  { id: '4', title: { en: 'Who We Are', de: 'Wer wir sind', fr: 'Qui nous sommes', es: 'Quiénes somos' }, slug: '/who-we-are', status: 'Published', createdBy: 'System', modifiedBy: 'Admin', modifiedDate: new Date().toISOString(), containers: createDefaultContainers('4') },
-  { id: '5', title: { en: 'Careers', de: 'Karriere', fr: 'Carrières', es: 'Carreras' }, slug: '/careers', status: 'Published', createdBy: 'System', modifiedBy: 'Admin', modifiedDate: new Date().toISOString(), containers: createDefaultContainers('5') },
-  { id: '6', title: { en: 'Contact', de: 'Kontakt', fr: 'Contact', es: 'Contacto' }, slug: '/contact', status: 'Published', createdBy: 'System', modifiedBy: 'Admin', modifiedDate: new Date().toISOString(), containers: createDefaultContainers('6') }
-];
+const recalculateFolderCounts = (folders: ImageFolder[], images: ImageItem[]): ImageFolder[] => {
+  return folders.map(f => {
+    if (f.id === 'all') return { ...f, count: images.length };
+    return { ...f, count: images.filter(i => i.folderId === f.id).length };
+  });
+};
 
-// --- CENTRALIZED MOCK DATA ---
-const MOCK_NEWS: NewsItem[] = [
-  { id: '1', title: 'New Office Opening in Berlin', status: 'Published', publishDate: '2025-01-10', description: 'We are thrilled to announce the opening of our new regional headquarters.', readMore: { enabled: true, text: 'Read more', url: '#' }, translations: { de: { title: 'Neues Büro', description: 'Wir freuen uns...' }, fr: { title: 'Nouveau bureau', description: 'Nous sommes ravis...' } } },
-  { id: 'mock_1', title: 'Global Expansion Strategy 2025', status: 'Published', publishDate: '2025-03-10', description: 'Our comprehensive plan to enter new markets in Asia and South America is now officially underway.', imageUrl: 'https://images.unsplash.com/photo-1526304640152-d4619684e484?auto=format&fit=crop&w=300&q=80', readMore: { enabled: true } },
-  { id: 'mock_2', title: 'Employee Wellness Week Highlights', status: 'Published', publishDate: '2025-02-28', description: 'A look back at the activities and workshops from our successful wellness week.', imageUrl: 'https://images.unsplash.com/photo-1577962917302-cd874c4e3169?auto=format&fit=crop&w=300&q=80', readMore: { enabled: true } },
-  { id: 'mock_3', title: 'Q1 Financial Results Announcement', status: 'Draft', publishDate: '2025-04-15', description: 'Upcoming announcement regarding the first quarter financial performance.', imageUrl: 'https://images.unsplash.com/photo-1551288049-bebda4e38f71?auto=format&fit=crop&w=300&q=80', readMore: { enabled: false } },
-  { id: 'mock_4', title: 'New IT Security Protocols', status: 'Published', publishDate: '2025-01-15', description: 'Important updates to our cybersecurity measures and employee guidelines.', imageUrl: 'https://images.unsplash.com/photo-1556761175-5973dc0f32e7?auto=format&fit=crop&w=300&q=80', readMore: { enabled: true } },
-  { id: 'mock_5', title: 'Sustainability Report 2024', status: 'Published', publishDate: '2024-12-20', description: 'Download the full report on our environmental impact and future goals.', imageUrl: 'https://images.unsplash.com/photo-1497366216548-37526070297c?auto=format&fit=crop&w=300&q=80', readMore: { enabled: true } },
-  { id: 'mock_6', title: 'Welcome to Our New CTO', status: 'Published', publishDate: '2025-03-01', description: 'We are pleased to welcome Sarah Jenkins to the executive leadership team.', imageUrl: 'https://images.unsplash.com/photo-1573496359142-b8d87734a5a2?auto=format&fit=crop&w=300&q=80', readMore: { enabled: true } },
-  { id: 'mock_7', title: 'Office Renovation Updates', status: 'Draft', publishDate: '2025-05-01', description: 'Phase 2 of the headquarters renovation begins next month.', imageUrl: 'https://images.unsplash.com/photo-1486406146926-c627a92ad1ab?auto=format&fit=crop&w=300&q=80', readMore: { enabled: false } },
-  { id: 'mock_8', title: 'Annual Charity Gala', status: 'Published', publishDate: '2024-11-10', description: 'Join us for an evening of giving back to our community partners.', imageUrl: 'https://images.unsplash.com/photo-1511632765486-a01980e01a18?auto=format&fit=crop&w=300&q=80', readMore: { enabled: true } },
-  { id: 'mock_9', title: 'Product Launch: X-Series', status: 'Published', publishDate: '2025-02-15', description: 'Introducing our latest innovation in enterprise software solutions.', imageUrl: 'https://images.unsplash.com/photo-1522071820081-009f0129c71c?auto=format&fit=crop&w=300&q=80', readMore: { enabled: true } },
-  { id: 'mock_10', title: 'Remote Work Policy Update', status: 'Published', publishDate: '2025-01-05', description: 'Clarifications on the hybrid work model and equipment allowances.', imageUrl: 'https://images.unsplash.com/photo-1593642632823-8f7853670c6e?auto=format&fit=crop&w=300&q=80', readMore: { enabled: true } }
-];
 
-const MOCK_EVENTS: EventItem[] = [
-  { id: 'e1', title: 'Annual Tech Conference 2025', status: 'Published', eventDate: '2025-06-15', description: 'Join us for the biggest tech conference of the year.', readMore: { enabled: true, text: 'Register Now', url: '#' }, translations: {} },
-  { id: 'mock_e1', title: 'Q3 Town Hall Meeting', status: 'Published', eventDate: '2025-08-15', description: 'Join leadership for updates on company performance and future goals.', imageUrl: 'https://images.unsplash.com/photo-1515187029135-18ee286d815b?auto=format&fit=crop&w=300&q=80', readMore: { enabled: true } },
-  { id: 'mock_e2', title: 'Developer Summit 2025', status: 'Published', eventDate: '2025-09-10', description: 'A 3-day deep dive into the latest technologies and frameworks.', imageUrl: 'https://images.unsplash.com/photo-1543269865-cbf427effbad?auto=format&fit=crop&w=300&q=80', readMore: { enabled: true } },
-  { id: 'mock_e3', title: 'Annual Charity Run', status: 'Draft', eventDate: '2025-10-05', description: 'Raise money for local charities by participating in our 5k run.', imageUrl: 'https://images.unsplash.com/photo-1552674605-46f5383a6d71?auto=format&fit=crop&w=300&q=80', readMore: { enabled: false } },
-  { id: 'mock_e4', title: 'New Hire Orientation', status: 'Published', eventDate: '2025-07-01', description: 'Welcoming our newest team members to the organization.', imageUrl: 'https://images.unsplash.com/photo-1521737604893-d14cc237f11d?auto=format&fit=crop&w=300&q=80', readMore: { enabled: true } },
-  { id: 'mock_e5', title: 'Product Launch: Alpha V2', status: 'Published', eventDate: '2025-11-20', description: 'The next generation of our flagship product is here.', imageUrl: 'https://images.unsplash.com/photo-1523240795612-9a054b0db644?auto=format&fit=crop&w=300&q=80', readMore: { enabled: true } },
-  { id: 'mock_e6', title: 'Holiday Party 2025', status: 'Draft', eventDate: '2025-12-18', description: 'Celebrate the end of a great year with food, drinks, and music.', imageUrl: 'https://images.unsplash.com/photo-1513151233558-d860c5398176?auto=format&fit=crop&w=300&q=80', readMore: { enabled: true } },
-  { id: 'mock_e7', title: 'Leadership Workshop', status: 'Published', eventDate: '2025-08-22', description: 'Training session for aspiring team leaders.', imageUrl: 'https://images.unsplash.com/photo-1517245386807-bb43f82c33c4?auto=format&fit=crop&w=300&q=80', readMore: { enabled: true } },
-  { id: 'mock_e8', title: 'Client Appreciation Dinner', status: 'Published', eventDate: '2025-09-25', description: 'An evening to thank our most loyal partners.', imageUrl: 'https://images.unsplash.com/photo-1511795409834-ef04bbd61622?auto=format&fit=crop&w=300&q=80', readMore: { enabled: true } }
-];
-
-const MOCK_DOCUMENTS: DocumentItem[] = [
-  { id: 'd1', title: 'Company Policy 2025', status: 'Draft', date: '2025-01-20', type: 'Word', year: '2025', description: 'Updated company policies.', itemRank: 'Policy', translations: {} },
-  { id: 'm1', title: 'Q1 Financial Report', status: 'Published', date: '2025-04-10', type: 'Excel', year: '2025', description: 'Quarterly financial analysis.', itemRank: 'Critical' },
-  { id: 'm2', title: 'Employee Handbook v2', status: 'Published', date: '2025-01-15', type: 'PDF', year: '2025', description: 'Updated HR policies.', itemRank: 'Standard' },
-  { id: 'm3', title: 'Project Alpha Proposal', status: 'Draft', date: '2025-03-22', type: 'Word', year: '2025', description: 'Initial proposal draft.', itemRank: 'Important' },
-  { id: 'm4', title: 'Marketing Assets Link', status: 'Published', date: '2024-11-05', type: 'Link', year: '2024', description: 'External drive link.', itemRank: 'Standard', url: 'https://drive.google.com' },
-  { id: 'm5', title: 'Q4 Board Presentation', status: 'Published', date: '2024-12-20', type: 'PPT', year: '2024', description: 'End of year review.', itemRank: 'Critical' },
-  { id: 'm6', title: 'IT Security Guidelines', status: 'Published', date: '2023-06-10', type: 'PDF', year: '2023', description: 'Security protocols.', itemRank: 'Standard' },
-  { id: 'm7', title: 'Budget Plan 2026', status: 'Draft', date: '2025-05-01', type: 'Excel', year: '2025', description: 'Forward looking budget.', itemRank: 'Critical' },
-  { id: 'm8', title: 'Brand Guidelines', status: 'Published', date: '2022-02-14', type: 'PDF', year: '2022', description: 'Corporate identity guide.', itemRank: 'Standard' },
-  { id: 'm9', title: 'Legacy Systems Manual', status: 'Published', date: '2020-08-30', type: 'Word', year: '2020', description: 'Old system documentation.', itemRank: 'Standard' }
-];
-
-const MOCK_FOLDERS: ImageFolder[] = [
-  { id: 'all', name: 'All Images', count: 8 },
-  { id: 'container', name: 'Container-Images', count: 3 },
-  { id: 'card', name: 'Card-Images', count: 0 },
-  { id: 'page', name: 'Page-Images', count: 3 },
-  { id: 'covers', name: 'Covers', count: 0 },
-  { id: 'team', name: 'TeamImages', count: 1 },
-  { id: 'footer', name: 'FooterUrl', count: 0 },
-  { id: 'logos', name: 'Logos', count: 0 },
-  { id: 'tiles', name: 'Tiles', count: 0 },
-  { id: 'flags', name: 'Flags', count: 1 },
-  { id: 'slider', name: 'SliderImages', count: 0 },
-];
-
-const MOCK_IMAGES: ImageItem[] = [
-  { id: 'i1', name: 'Text Edit(10).png', url: '', folderId: 'container', title: 'Text Edit Image', createdDate: '2025-03-18', createdBy: 'Sameer Gupta' },
-  { id: 'i2', name: 'benefit-img2.jpg', url: '', folderId: 'container', title: 'Benefit Image 2', createdDate: '2025-03-18', createdBy: 'Sameer Gupta' },
-  { id: 'i3', name: 'benefit-img1.png', url: '', folderId: 'container', title: 'Benefit Image 1', createdDate: '2025-03-18', createdBy: 'Sameer Gupta' },
-  { id: 'i4', name: 'GR_Hochhuth_Strategie_page-0002.jpg', url: '', folderId: 'page', title: 'Strategy Page 2', createdDate: '2025-03-18', createdBy: 'Sameer Gupta' },
-  { id: 'i5', name: 'GR_Hochhuth_Strategie_page-0001.jpg', url: '', folderId: 'page', title: 'Strategy Page 1', createdDate: '2025-03-18', createdBy: 'Sameer Gupta' },
-  { id: 'i6', name: 'GR_Hochhuth_Strategie_page-0001-1.jpg', url: '', folderId: 'page', title: 'Strategy Page 1.1', createdDate: '2025-03-18', createdBy: 'Sameer Gupta' },
-  { id: 'i7', name: 'Team_Meeting.jpg', url: '', folderId: 'team', title: 'Team Meeting', createdDate: '2025-03-15', createdBy: 'Admin' },
-  { id: 'i8', name: 'Flag_US.png', url: '', folderId: 'flags', title: 'US Flag', createdDate: '2025-01-10', createdBy: 'System' },
-];
-
-const MOCK_TRANSLATION_ITEMS: TranslationItem[] = [
-  { id: '#5', sourceList: 'TopNavigation', original: 'Home', translations: { de: 'Startseite', fr: 'Accueil' }, lastUpdated: '31/12/2025' },
-  { id: '#6', sourceList: 'TopNavigation', original: 'What we offer', translations: { de: 'Was wir bieten', fr: 'Ce que nous offrons' }, lastUpdated: '31/12/2025' },
-];
-
 const MOCK_USERS: PermissionUser[] = [
   { id: 'u1', name: 'Abhishek Tiwari', email: 'abhishek.tiwari@webstudio.de' },
   { id: 'u2', name: 'Aditi Mishra', email: 'aditi.mishra@webstudio.de' },
@@ -658,11 +219,14 @@
   { id: 'owners', name: 'WebStudio Owners', description: 'Manage high-level permissions for administrators and owners. Use with caution.', type: 'Owners', memberIds: ['u6'] },
 ];
 
-const recalculateFolderCounts = (folders: ImageFolder[], images: ImageItem[]): ImageFolder[] => {
-  return folders.map(f => {
-    if (f.id === 'all') return { ...f, count: images.length };
-    return { ...f, count: images.filter(i => i.folderId === f.id).length };
-  });
+const unescapeHtml = (str: string): string => {
+  if (!str) return '';
+  return str
+    .replace(/&lt;/g, '<')
+    .replace(/&gt;/g, '>')
+    .replace(/&quot;/g, '"')
+    .replace(/&#039;/g, "'")
+    .replace(/&amp;/g, '&');
 };
 
 interface AppState {
@@ -680,6 +244,8 @@
   permissionGroups: PermissionGroup[];
   permissionUsers: PermissionUser[];
   contactQueries: ContactQuery[];
+  containerItems: ContainerItem[];
+  contacts: ContactItem[];
   currentPageId: string;
   currentLanguage: LanguageCode;
 
@@ -701,215 +267,1721 @@
   updateNavAlignment: (align: SiteConfig['navAlignment']) => void;
   updateHeaderConfig: (config: Partial<SiteConfig>) => void;
   updateLogo: (logo: SiteConfig['logo']) => void;
-  addNavItem: (item: NavItem) => void;
-  updateNavItem: (item: NavItem) => void;
-  deleteNavItem: (id: string) => void;
+  addNavItem: (item: NavItem) => Promise<void>;
+  updateNavItem: (item: NavItem) => Promise<void>;
+  deleteNavItem: (id: string) => Promise<void>;
 
-  addNews: (item: NewsItem) => void;
-  updateNews: (item: NewsItem) => void;
-  deleteNews: (id: string) => void;
+  addNews: (item: NewsItem) => Promise<NewsItem | null>;
+  updateNews: (item: NewsItem) => Promise<void>;
+  deleteNews: (id: string) => Promise<void>;
 
-  addEvent: (item: EventItem) => void;
+  addEvent: (item: EventItem) => Promise<EventItem | null>;
   updateEvent: (item: EventItem) => void;
   deleteEvent: (id: string) => void;
 
-  addDocument: (item: DocumentItem) => void;
-  updateDocument: (item: DocumentItem) => void;
-  deleteDocument: (id: string) => void;
+  addDocument: (item: DocumentItem) => Promise<DocumentItem | null>;
+  updateDocument: (item: DocumentItem) => Promise<void>;
+  deleteDocument: (id: string) => Promise<void>;
 
+  addContainerItem: (item: ContainerItem) => Promise<ContainerItem | null>;
+  updateContainerItem: (item: ContainerItem) => void;
+  deleteContainerItem: (id: string) => void;
+
+  addContact: (item: ContactItem) => Promise<ContactItem | null>;
+  updateContact: (item: ContactItem) => Promise<void>;
+  deleteContact: (id: string) => Promise<void>;
+
   addImage: (item: ImageItem) => void;
-  updateImage: (item: ImageItem) => void;
-  deleteImage: (id: string) => void;
+  uploadImage: (file: File, folderId?: string, metadata?: any) => Promise<ImageItem | null>;
+  checkImageExists: (fileName: string, folderId?: string) => Promise<boolean>;
+  updateImage: (item: ImageItem) => Promise<void>;
+  deleteImage: (id: string) => Promise<void>;
 
   updateTranslationItem: (id: string, sourceList: string, original: string, lang: string, value: string) => void;
 
   // Permission Actions
   createPermissionGroup: (group: PermissionGroup) => void;
   updatePermissionGroup: (group: PermissionGroup) => void;
-  addMemberToGroup: (groupId: any, userId: any) => void;
-  removeMemberFromGroup: (groupId: any, userId: any) => void;
+  addMemberToGroup: (groupId: string, userId: string) => void;
+  removeMemberFromGroup: (groupId: string, userId: string) => void;
 
   // Contact Query Actions
-  addContactQuery: (query: ContactQuery) => void;
-  deleteContactQuery: (ids: any) => void;
+  addContactQuery: (query: ContactQuery) => Promise<void>;
+  deleteContactQuery: (ids: string[]) => Promise<void>;
 
   updateFooterConfig: (config: Partial<SiteConfig['footer']>) => void;
 
   openLabelEditor: (key: string) => void;
   updateLabel: (key: string, text: string, lang: LanguageCode) => void;
 
-  addPage: (page: Page) => void;
-  updatePage: (page: Page) => void;
-  addContainer: (pageId: string, container: Container) => void;
-  updateContainer: (pageId: string, container: Container) => void;
-  deleteContainer: (pageId: string, cId: any) => void;
+  addPage: (page: Page) => Promise<Page | null>;
+  updatePage: (page: Page) => Promise<void>;
+  deletePage: (id: string) => Promise<void>;
+  addContainer: (pageId: string, container: Container) => Promise<Container | null>;
+  updateContainer: (pageId: string, container: Container) => Promise<void>;
+  deleteContainer: (pageId: string, cId: string) => Promise<void>;
   reorderContainers: (pageId: string, newOrder: Container[]) => void;
-}
 
-export const useStore = create<AppState>()(
-  persist(
-    (set) => ({
-      viewMode: ViewMode.PREVIEW,
-      activeModal: ModalType.NONE,
-      themeConfig: DEFAULT_THEME,
-      pages: MOCK_PAGES,
-      news: MOCK_NEWS,
-      events: MOCK_EVENTS,
-      documents: MOCK_DOCUMENTS,
-      images: MOCK_IMAGES,
-      imageFolders: MOCK_FOLDERS,
-      translationItems: MOCK_TRANSLATION_ITEMS,
-      permissionGroups: MOCK_GROUPS,
-      permissionUsers: MOCK_USERS,
-      contactQueries: [],
-      currentPageId: '1',
-      currentLanguage: 'en',
-      uiLabels: INITIAL_UI_LABELS,
-      editingLabelKey: null,
-      editingContainerId: null,
-      siteConfig: {
-        name: 'My Enterprise Site',
-        languages: ['en', 'de', 'fr', 'es'],
-        defaultLanguage: 'en',
-        navPosition: 'right',
-        navAlignment: 'center',
-        headerWidth: 'full',
-        headerBackgroundColor: '#ffffff',
-        logo: { url: '', position: 'left', width: '150px' },
-        navigation: MOCK_NAV,
-        footer: {
-          template: 'Table',
-          backgroundColor: 'site-color',
-          alignment: 'left',
-          subFooterText: 'Powered By : Web Studio CMS',
-          fontSettings: { headingSize: '16px', subHeadingSize: '14px' },
-          columns: [
-            { id: '1', title: 'Platform', links: [{ id: 'l1', label: 'SharePoint Online', url: '#' }, { id: 'l2', label: 'Power Platform', url: '#' }] },
-            { id: '2', title: 'Legal', links: [{ id: 'l4', label: 'Privacy Policy', url: '#' }, { id: 'l5', label: 'Terms of Service', url: '#' }] },
-            { id: '3', title: 'Company', links: [{ id: 'l7', label: 'About Us', url: '#' }, { id: 'l9', label: 'Contact', url: '#' }] }
-          ],
-          contactInfo: { address: 'Christinenstr 16, 10119 Berlin', email: 'info@webstudio.de', phone: '+49 30 868706600' },
-          socialLinks: { linkedin: 'https://linkedin.com', facebook: '', twitter: '', instagram: '' },
-          copyright: { en: '© 2026 Web Studio Corp', de: '© 2026 Unternehmen Corp', fr: '© 2026 Entreprise Corp', es: '© 2026 Empresa Corp' }
-        }
-      },
+  // SharePoint Data Loading Actions
+  loadFromSharePoint: () => Promise<void>;
+  saveGlobalSettings: (type: 'theme' | 'site' | 'labels' | 'app') => Promise<void>;
+  syncTranslations: () => Promise<void>;
+  setLoading: (loading: boolean) => void;
+  isLoading: boolean;
 
-      toggleViewMode: () => set((state) => ({ viewMode: state.viewMode === ViewMode.PREVIEW ? ViewMode.EDIT : ViewMode.PREVIEW })),
-      openModal: (type) => set({ activeModal: type }),
-      closeModal: () => set({ activeModal: ModalType.NONE, editingLabelKey: null, editingContainerId: null }),
-      updateThemeVar: (key, value) => set((state) => ({ themeConfig: { ...state.themeConfig, [key]: value } })),
-      setThemeConfig: (config) => set({ themeConfig: config }),
-      setCurrentPage: (id) => set({ currentPageId: id }),
-      resetTheme: () => set({ themeConfig: DEFAULT_THEME }),
-      setLanguage: (lang) => set({ currentLanguage: lang }),
-      setEditingContainerId: (id) => set({ editingContainerId: id }),
+  activeTranslationSource: string;
+  setTranslationSource: (source: string) => void;
+  translationSources: string[];
 
-      updateNavPosition: (pos) => set((state) => ({ siteConfig: { ...state.siteConfig, navPosition: pos } })),
-      updateNavAlignment: (align) => set((state) => ({ siteConfig: { ...state.siteConfig, navAlignment: align } })),
-      updateHeaderConfig: (config) => set((state) => ({ siteConfig: { ...state.siteConfig, ...config } })),
-      updateLogo: (logo) => set((state) => ({ siteConfig: { ...state.siteConfig, logo } })),
-      addNavItem: (item) => set((state) => ({ siteConfig: { ...state.siteConfig, navigation: [...state.siteConfig.navigation, item] } })),
-      updateNavItem: (item) => set((state) => ({ siteConfig: { ...state.siteConfig, navigation: state.siteConfig.navigation.map(n => n.id === item.id ? item : n) } })),
-      deleteNavItem: (id) => set((state) => ({ siteConfig: { ...state.siteConfig, navigation: state.siteConfig.navigation.filter(n => n.id !== id && n.parentId !== id) } })),
+  // Helper functions for managing taggedItems
+  removeItemFromContainers: (itemId: string) => Promise<void>;
+  validateContainerTaggedItems: () => Promise<void>;
+}
 
-      addNews: (item) => set((state) => ({ news: [...state.news, item] })),
-      updateNews: (item) => set((state) => ({ news: state.news.map(n => n.id === item.id ? item : n) })),
-      deleteNews: (id) => set((state) => ({ news: state.news.filter(n => n.id !== id) })),
+export const useStore = create<AppState>()(
+  (set, get) => ({
+    viewMode: ViewMode.EDIT,
+    activeModal: ModalType.NONE,
+    themeConfig: DEFAULT_THEME,
+    pages: [],
+    news: [],
+    events: [],
+    documents: [],
+    containerItems: [],
+    contacts: [],
+    images: [],
+    imageFolders: [],
+    translationItems: [],
+    permissionGroups: MOCK_GROUPS,
+    permissionUsers: MOCK_USERS,
+    contactQueries: [],
+    currentPageId: '1',
+    currentLanguage: 'en',
+    uiLabels: INITIAL_UI_LABELS,
+    editingLabelKey: null,
+    editingContainerId: null,
+    isLoading: false,
+    activeTranslationSource: 'TopNavigation',
+    translationSources: [
+      'TopNavigation',
+      'SmartPages',
+      'News',
+      'Events',
+      'Documents',
+      'Containers',
+      'GlobalSettings',
+      'ContactQueries',
+      'TranslationDictionary',
+      'Images',
+      'ContainerItems',
+      'Contacts'
+    ],
+    siteConfig: {
+      name: 'My Enterprise Site',
+      languages: ['en', 'de', 'fr', 'es'],
+      defaultLanguage: 'en',
+      navPosition: 'right',
+      navAlignment: 'center',
+      headerWidth: 'full',
+      headerBackgroundColor: '#ffffff',
+      logo: { url: '', position: 'left', width: '150px' },
+      navigation: [],
+      footer: {
+        template: 'Table',
+        backgroundColor: 'site-color',
+        alignment: 'left',
+        subFooterText: 'Powered By : Web Studio CMS',
+        fontSettings: { headingSize: '16px', subHeadingSize: '14px' },
+        columns: [
+          { id: '1', title: 'Platform', links: [{ id: 'l1', label: 'SharePoint Online', url: '#' }, { id: 'l2', label: 'Power Platform', url: '#' }] },
+          { id: '2', title: 'Legal', links: [{ id: 'l4', label: 'Privacy Policy', url: '#' }, { id: 'l5', label: 'Terms of Service', url: '#' }] },
+          { id: '3', title: 'Company', links: [{ id: 'l7', label: 'About Us', url: '#' }, { id: 'l9', label: 'Contact', url: '#' }] }
+        ],
+        contactInfo: { address: 'Christinenstr 16, 10119 Berlin', email: 'info@webstudio.de', phone: '+49 30 868706600' },
+        socialLinks: { linkedin: 'https://linkedin.com', facebook: '', twitter: '', instagram: '' },
+        copyright: { en: '© 2026 Web Studio Corp', de: '© 2026 Unternehmen Corp', fr: '© 2026 Entreprise Corp', es: '© 2026 Empresa Corp' }
+      }
+    },
 
-      addEvent: (item) => set((state) => ({ events: [...state.events, item] })),
-      updateEvent: (item) => set((state) => ({ events: state.events.map(n => n.id === item.id ? item : n) })),
-      deleteEvent: (id) => set((state) => ({ events: state.events.filter(n => n.id !== id) })),
+    toggleViewMode: () => set((state) => ({ viewMode: state.viewMode === ViewMode.PREVIEW ? ViewMode.EDIT : ViewMode.PREVIEW })),
+    openModal: (type) => set({ activeModal: type }),
+    closeModal: () => set({ activeModal: ModalType.NONE, editingLabelKey: null, editingContainerId: null }),
+    updateThemeVar: (key, value) => {
+      set((state) => ({ themeConfig: { ...state.themeConfig, [key]: value } }));
+      get().saveGlobalSettings('theme');
+    },
+    setThemeConfig: (config) => {
+      set({ themeConfig: config });
+      get().saveGlobalSettings('theme');
+    },
+    setCurrentPage: (id) => {
+      const state = get();
+      const page = state.pages.find(p => p.id === id);
+      if (page) {
+        const hash = page.slug === '/' ? '' : page.slug;
+        if (window.location.hash !== `#${hash}`) {
+          window.location.hash = hash;
+        }
+        // Also set it immediately for responsiveness
+        set({ currentPageId: id });
+      }
+      get().saveGlobalSettings('app');
+    },
+    resetTheme: () => {
+      set({ themeConfig: DEFAULT_THEME });
+      get().saveGlobalSettings('theme');
+    },
+    setLanguage: (lang) => {
+      set({ currentLanguage: lang });
+      get().saveGlobalSettings('app');
+    },
+    setEditingContainerId: (id) => {
+      set({ editingContainerId: id });
+      get().saveGlobalSettings('app');
+    },
+    setTranslationSource: (source) => set({ activeTranslationSource: source }),
 
-      addDocument: (item) => set((state) => ({ documents: [...state.documents, item] })),
-      updateDocument: (item) => set((state) => ({ documents: state.documents.map(n => n.id === item.id ? item : n) })),
-      deleteDocument: (id) => set((state) => ({ documents: state.documents.filter(n => n.id !== id) })),
+    updateNavPosition: (pos) => {
+      set((state) => ({ siteConfig: { ...state.siteConfig, navPosition: pos } }));
+      get().saveGlobalSettings('site');
+    },
+    updateNavAlignment: (align) => {
+      set((state) => ({ siteConfig: { ...state.siteConfig, navAlignment: align } }));
+      get().saveGlobalSettings('site');
+    },
+    updateHeaderConfig: (config) => {
+      set((state) => ({ siteConfig: { ...state.siteConfig, ...config } }));
+      get().saveGlobalSettings('site');
+    },
+    updateLogo: (logo) => {
+      set((state) => ({ siteConfig: { ...state.siteConfig, logo } }));
+      get().saveGlobalSettings('site');
+    },
+    addNavItem: async (item) => {
+      try {
+        const { saveNavItem } = await import(/* webpackChunkName: 'sp-service' */ './services/SPService');
+        const spData = {
+          Title: item.title,
+          ParentId: item.parentId !== 'root' ? Number(item.parentId) : null,
+          NavType: item.type,
+          SmartPageId: item.pageId ? Number(item.pageId) : null,
+          ExternalURL: item.url || '',
+          SortOrder: item.order,
+          IsVisible: item.isVisible,
+          OpenInNewTab: item.openInNewTab || false,
+          Translations: JSON.stringify(item.translations || {})
+        };
+        const result = await saveNavItem(spData);
+        const realId = result.Id || result.data.Id;
+        const newItem = { ...item, id: String(realId) };
+        set((state) => ({ siteConfig: { ...state.siteConfig, navigation: [...state.siteConfig.navigation, newItem] } }));
+      } catch (error) {
+        console.error('Error adding nav item:', error);
+      }
+    },
 
-      addImage: (item) => set((state) => {
-        const newImages = [...state.images, item];
-        return {
-          images: newImages,
-          imageFolders: recalculateFolderCounts(state.imageFolders, newImages)
+    updateNavItem: async (item) => {
+      try {
+        const { updateNavItem: updateNavItemSP } = await import(/* webpackChunkName: 'sp-service' */ './services/SPService');
+        const spData = {
+          Title: item.title,
+          ParentId: item.parentId !== 'root' ? Number(item.parentId) : null,
+          NavType: item.type,
+          SmartPageId: item.pageId ? Number(item.pageId) : null,
+          ExternalURL: item.url || '',
+          SortOrder: item.order,
+          IsVisible: item.isVisible,
+          OpenInNewTab: item.openInNewTab || false,
+          Translations: JSON.stringify(item.translations || {})
         };
-      }),
-      updateImage: (item) => set((state) => {
-        const newImages = state.images.map(i => i.id === item.id ? item : i);
-        return {
-          images: newImages,
-          imageFolders: recalculateFolderCounts(state.imageFolders, newImages)
-        };
-      }),
-      deleteImage: (id) => set((state) => {
-        const newImages = state.images.filter(i => i.id !== id);
-        return {
-          images: newImages,
-          imageFolders: recalculateFolderCounts(state.imageFolders, newImages)
-        };
-      }),
+        await updateNavItemSP(Number(item.id), spData);
+        set((state) => ({ siteConfig: { ...state.siteConfig, navigation: state.siteConfig.navigation.map(n => n.id === item.id ? item : n) } }));
+      } catch (error) {
+        console.error('Error updating nav item:', error);
+      }
+    },
 
-      updateTranslationItem: (id, sourceList, original, lang, value) => set((state) => {
-        const existingIndex = state.translationItems.findIndex(item => item.id === id);
-        if (existingIndex >= 0) {
-          const newItems = [...state.translationItems];
-          newItems[existingIndex] = {
-            ...newItems[existingIndex],
-            translations: { ...newItems[existingIndex].translations, [lang]: value },
-            lastUpdated: new Date().toLocaleDateString('en-GB')
-          };
-          return { translationItems: newItems };
-        } else {
-          const newItem: TranslationItem = {
-            id,
-            sourceList,
-            original,
-            translations: { [lang]: value },
-            lastUpdated: new Date().toLocaleDateString('en-GB')
-          };
-          return { translationItems: [...state.translationItems, newItem] };
-        }
-      }),
+    deleteNavItem: async (id) => {
+      try {
+        const { deleteNavItem: deleteNavItemSP } = await import(/* webpackChunkName: 'sp-service' */ './services/SPService');
+        await deleteNavItemSP(Number(id));
+        set((state) => ({ siteConfig: { ...state.siteConfig, navigation: state.siteConfig.navigation.filter(n => n.id !== id && n.parentId !== id) } }));
+      } catch (error) {
+        console.error('Error deleting nav item:', error);
+      }
+    },
 
-      // Permission Actions
-      createPermissionGroup: (group) => set((state) => ({ permissionGroups: [...state.permissionGroups, group] })),
-      updatePermissionGroup: (group) => set((state) => ({ permissionGroups: state.permissionGroups.map(g => g.id === group.id ? group : g) })),
-      addMemberToGroup: (groupId, userId) => set((state) => ({
-        permissionGroups: state.permissionGroups.map(g => g.id === groupId ? { ...g, memberIds: [...g.memberIds, userId] } : g)
-      })),
-      removeMemberFromGroup: (groupId, userId) => set((state) => ({
-        permissionGroups: state.permissionGroups.map(g => g.id === groupId ? { ...g, memberIds: g.memberIds.filter(id => id !== userId) } : g)
-      })),
-
-      // Contact Query Actions
-      addContactQuery: (query) => set((state) => ({ contactQueries: [query, ...state.contactQueries] })),
-      deleteContactQuery: (ids) => set((state) => ({ contactQueries: state.contactQueries.filter(q => !ids.includes(q.id)) })),
-
-      updateFooterConfig: (config) => set((state) => ({ siteConfig: { ...state.siteConfig, footer: { ...state.siteConfig.footer, ...config } } })),
-
-      openLabelEditor: (key) => set({ activeModal: ModalType.LABEL_EDITOR, editingLabelKey: key }),
-      updateLabel: (key, text, lang) => set((state) => ({ uiLabels: { ...state.uiLabels, [key]: { ...state.uiLabels[key], [lang]: text } }, activeModal: ModalType.NONE, editingLabelKey: null })),
-
-      addPage: (page) => set((state) => ({ pages: [...state.pages, { ...page, containers: page.containers && page.containers.length > 0 ? page.containers : createDefaultContainers(page.id) }] })),
-      updatePage: (page) => set((state) => ({ pages: state.pages.map(p => p.id === page.id ? page : p) })),
-      addContainer: (pageId, container) => set((state) => ({ pages: state.pages.map(p => p.id === pageId ? { ...p, containers: [...p.containers, { ...container, pageId }] } : p) })),
-      updateContainer: (pageId, container) => set((state) => ({ pages: state.pages.map(p => p.id === pageId ? { ...p, containers: p.containers.map(c => c.id === container.id ? container : c) } : p) })),
-      deleteContainer: (pageId, cId) => set((state) => ({ pages: state.pages.map(p => p.id === pageId ? { ...p, containers: p.containers.filter(c => c.id !== cId) } : p) })),
-      reorderContainers: (pageId, newOrder) => set((state) => ({ pages: state.pages.map(p => p.id === pageId ? { ...p, containers: newOrder } : p) })),
-    }),
-    {
-      name: 'web-studio-storage',
-      storage: createJSONStorage(() => localStorage),
-      partialize: (state) => ({ themeConfig: state.themeConfig, siteConfig: state.siteConfig, pages: state.pages, news: state.news, events: state.events, documents: state.documents, images: state.images, currentLanguage: state.currentLanguage, uiLabels: state.uiLabels, translationItems: state.translationItems, permissionGroups: state.permissionGroups, permissionUsers: state.permissionUsers, contactQueries: state.contactQueries }),
-    }
-  )
+    addNews: async (item) => {
+      try {
+        const { saveNews } = await import(/* webpackChunkName: 'sp-service' */ './services/SPService');
+        const spData = {
+          Title: item.title,
+          Status: item.status,
+          PublishDate: item.publishDate,
+          Description: item.description,
+          ReadMoreURL: item.readMore?.url || '',
+          ReadMoreText: item.readMore?.text || '',
+          ReadMoreEnabled: item.readMore?.enabled || false,
+          SEOConfig: JSON.stringify(item.seo || {}),
+          Translations: JSON.stringify(item.translations || {}),
+          ImageUrl: { Url: item.imageUrl || '', Description: item.imageName || '' },
+          ImageName: item.imageName || ''
+        };
+        const result = await saveNews(spData);
+        console.log('saveNews Result:', result); // Debugging
+        // PnPjs returns { data: { Id: ... } }
+        const realId = result.data ? result.data.Id : result.Id;
+        const newItem = { ...item, id: String(realId) };
+        set((state) => ({ news: [...state.news, newItem] }));
+        return newItem;
+      } catch (error) {
+        console.error('Error adding news:', error);
+        return null;
+      }
+    },
+
+    updateNews: async (item) => {
+      try {
+        // Update local state immediately for responsiveness
+        set((state) => ({ news: state.news.map(n => n.id === item.id ? item : n) }));
+
+        // Verify ID is numeric (real SP item) before calling service
+        if (!isNaN(Number(item.id))) {
+          const { updateNews: updateNewsSP } = await import(/* webpackChunkName: 'sp-service' */ './services/SPService');
+          if (updateNewsSP) {
+            const spData = {
+              Title: item.title,
+              Status: item.status,
+              PublishDate: item.publishDate,
+              Description: item.description,
+              ReadMoreURL: item.readMore?.url || '',
+              ReadMoreText: item.readMore?.text || '',
+              ReadMoreEnabled: item.readMore?.enabled || false,
+              SEOConfig: JSON.stringify(item.seo || {}),
+              Translations: JSON.stringify(item.translations || {}),
+              ImageUrl: { Url: item.imageUrl || '', Description: item.imageName || '' },
+              ImageName: item.imageName || ''
+            };
+            await updateNewsSP(Number(item.id), spData);
+            console.log(`✅ News updated in SharePoint: ${item.id}`);
+          }
+        } else {
+          console.warn(`Skipping SP update for non-numeric News ID: ${item.id}`);
+        }
+      } catch (error) {
+        console.error('Error updating news:', error);
+        // Optionally revert local state here if needed
+      }
+    },
+
+    deleteNews: async (id) => {
+      try {
+        if (!isNaN(Number(id))) {
+          const { deleteNews: deleteNewsSP } = await import(/* webpackChunkName: 'sp-service' */ './services/SPService');
+          await deleteNewsSP(Number(id));
+        } else {
+          console.warn(`Skipping SP delete for non-numeric News ID: ${id}`);
+        }
+        set((state) => ({ news: state.news.filter(n => n.id !== id) }));
+
+        // Remove from all containers' taggedItems
+        get().removeItemFromContainers(id);
+      } catch (error) {
+        console.error('Error deleting news:', error);
+      }
+    },
+
+    addEvent: async (item) => {
+      try {
+        const { saveEvent } = await import(/* webpackChunkName: 'sp-service' */ './services/SPService');
+        const spData = {
+          Title: item.title,
+          StartDate: item.startDate,
+          EndDate: item.endDate,
+          Location: item.location,
+          Description: item.description,
+          Category: item.category,
+          Translations: JSON.stringify(item.translations || {}),
+          Status: item.status,
+          ImageUrl: { Url: item.imageUrl || '', Description: item.imageName || '' },
+          ImageName: item.imageName || '',
+          ReadMoreURL: item.readMore?.url || '',
+          ReadMoreText: item.readMore?.text || '',
+          ReadMoreEnabled: item.readMore?.enabled || false,
+          SEOConfig: JSON.stringify(item.seo || {})
+        };
+        const result = await saveEvent(spData);
+        console.log('saveEvent Result:', result); // Debugging
+        const realId = result.data ? result.data.Id : result.Id;
+        const newItem = { ...item, id: String(realId) };
+        set((state) => ({ events: [...state.events, newItem] }));
+        return newItem;
+      } catch (error) {
+        console.error('Error adding event:', error);
+        return null;
+      }
+    },
+    updateEvent: async (item) => {
+      try {
+        // Update local state immediately
+        set((state) => ({ events: state.events.map(n => n.id === item.id ? item : n) }));
+
+        if (!isNaN(Number(item.id))) {
+          const { updateEvent: updateEventSP } = await import(/* webpackChunkName: 'sp-service' */ './services/SPService');
+          if (updateEventSP) {
+            const spData = {
+              Title: item.title,
+              StartDate: item.startDate,
+              EndDate: item.endDate,
+              Location: item.location,
+              Description: item.description,
+              Category: item.category,
+              Translations: JSON.stringify(item.translations || {}),
+              Status: item.status,
+              ImageUrl: { Url: item.imageUrl || '', Description: item.imageName || '' },
+              ImageName: item.imageName || '',
+              ReadMoreURL: item.readMore?.url || '',
+              ReadMoreText: item.readMore?.text || '',
+              ReadMoreEnabled: item.readMore?.enabled || false,
+              SEOConfig: JSON.stringify(item.seo || {})
+            };
+            await updateEventSP(Number(item.id), spData);
+            console.log(`✅ Event updated in SharePoint: ${item.id}`);
+          }
+        } else {
+          console.warn(`Skipping SP update for non-numeric Event ID: ${item.id}`);
+        }
+      } catch (error) {
+        console.error('Error updating event:', error);
+      }
+    },
+    deleteEvent: async (id) => {
+      try {
+        if (!isNaN(Number(id))) {
+          const { deleteEvent: deleteEventSP } = await import(/* webpackChunkName: 'sp-service' */ './services/SPService');
+          await deleteEventSP(Number(id));
+        } else {
+          console.warn(`Skipping SP delete for non-numeric Event ID: ${id}`);
+        }
+        set((state) => ({ events: state.events.filter(n => n.id !== id) }));
+
+        // Remove from all containers' taggedItems
+        get().removeItemFromContainers(id);
+      } catch (error) {
+        console.error('Error deleting event:', error);
+      }
+    },
+
+    addDocument: async (item) => {
+      try {
+        const { saveDocument } = await import(/* webpackChunkName: 'sp-service' */ './services/SPService');
+        const spData = {
+          Title: item.title,
+          DocStatus: item.status,
+          DocumentYear: item.year,
+          DocumentDescriptions: item.description,
+          ItemRank: item.itemRank,
+          DocType: item.type,
+          FileRef: item.url,
+          File: item.file,
+          SortOrder: item.sortOrder || 0,
+          Translations: item.translations ? JSON.stringify(item.translations) : '{}',
+          ImageUrl: { Url: item.imageUrl || '', Description: item.imageName || '' },
+          ImageName: item.imageName || ''
+        };
+        const result = await saveDocument(spData);
+        console.log('saveDocument Result:', result); // Debugging
+        const realId = result.data ? result.data.Id : result.Id;
+        const newItem = { ...item, id: String(realId) };
+        set((state) => ({ documents: [...state.documents, newItem] }));
+        return newItem;
+      } catch (error) {
+        console.error('Error adding document:', error);
+        return null;
+      }
+    },
+
+    updateDocument: async (item) => {
+      try {
+        const { updateDocument: updateDocumentSP } = await import(/* webpackChunkName: 'sp-service' */ './services/SPService');
+        const spData = {
+          Title: item.title,
+          Name: item.name, // Include for rename detection
+          DocumentYear: item.year,
+          DocStatus: item.status,
+          ItemRank: item.itemRank,
+          DocType: item.type,
+          DocumentDescriptions: item.description,
+          SortOrder: item.sortOrder || 0,
+          Translations: item.translations ? JSON.stringify(item.translations) : '{}',
+          ImageUrl: { Url: item.imageUrl || '', Description: item.imageName || '' },
+          ImageName: item.imageName || '',
+        };
+        await updateDocumentSP(Number(item.id), spData);
+        set((state) => ({ documents: state.documents.map(n => n.id === item.id ? item : n) }));
+      } catch (error) {
+        console.error('Error updating document:', error);
+      }
+    },
+
+    deleteDocument: async (id) => {
+      try {
+        const { deleteDocument: deleteDocumentSP } = await import(/* webpackChunkName: 'sp-service' */ './services/SPService');
+        await deleteDocumentSP(Number(id));
+        set((state) => ({ documents: state.documents.filter(n => n.id !== id) }));
+
+        // Remove from all containers' taggedItems
+        get().removeItemFromContainers(id);
+      } catch (error) {
+        console.error('Error deleting document:', error);
+      }
+    },
+
+    addContainerItem: async (item) => {
+      try {
+        const { saveContainerItem } = await import(/* webpackChunkName: 'sp-service' */ './services/SPService');
+        const spData = {
+          Title: item.title,
+          Status: item.status,
+          SortOrder: item.sortOrder,
+          Description: item.description,
+          Translations: JSON.stringify(item.translations || {}),
+          ImageUrl: { Url: item.imageUrl || '', Description: item.imageName || '' },
+          ImageName: item.imageName || ''
+        };
+        const result = await saveContainerItem(spData);
+        const realId = result.data ? result.data.Id : result.Id;
+        const newItem = { ...item, id: String(realId) };
+        set((state) => ({ containerItems: [...state.containerItems, newItem] }));
+        return newItem;
+      } catch (error) {
+        console.error('Error adding container item:', error);
+        return null;
+      }
+    },
+
+    updateContainerItem: async (item) => {
+      try {
+        set((state) => ({ containerItems: state.containerItems.map(n => n.id === item.id ? item : n) }));
+        if (!isNaN(Number(item.id))) {
+          const { updateContainerItem: updateContainerItemSP } = await import(/* webpackChunkName: 'sp-service' */ './services/SPService');
+          const spData = {
+            Title: item.title,
+            Status: item.status,
+            SortOrder: item.sortOrder,
+            Description: item.description,
+            Translations: JSON.stringify(item.translations || {}),
+            ImageUrl: { Url: item.imageUrl || '', Description: item.imageName || '' },
+            ImageName: item.imageName || ''
+          };
+          await updateContainerItemSP(Number(item.id), spData);
+        }
+      } catch (error) {
+        console.error('Error updating container item:', error);
+      }
+    },
+
+    deleteContainerItem: async (id) => {
+      try {
+        if (!isNaN(Number(id))) {
+          const { deleteContainerItem: deleteContainerItemSP } = await import(/* webpackChunkName: 'sp-service' */ './services/SPService');
+          await deleteContainerItemSP(Number(id));
+        }
+        set((state) => ({ containerItems: state.containerItems.filter(n => n.id !== id) }));
+
+        // Remove from all containers' taggedItems
+        get().removeItemFromContainers(id);
+      } catch (error) {
+        console.error('Error deleting container item:', error);
+      }
+    },
+
+    addContact: async (item) => {
+      try {
+        const { saveContact } = await import(/* webpackChunkName: 'sp-service' */ './services/SPService');
+        const spData = {
+          Title: item.fullName,
+          FirstName: item.firstName || '',
+          LastName: item.lastName || '',
+          Status: item.status,
+          SortOrder: item.sortOrder,
+          JobTitle: item.jobTitle || '',
+          Company: item.company || '',
+          Email: item.email || '',
+          Phone: item.phone || '',
+          Description: item.description,
+          Translations: JSON.stringify(item.translations || {}),
+          ImageUrl: { Url: item.imageUrl || '', Description: item.imageName || '' },
+          ImageName: item.imageName || ''
+        };
+        const result = await saveContact(spData);
+        const realId = result.data ? result.data.Id : result.Id;
+        const newItem = { ...item, id: String(realId) };
+        set((state) => ({ contacts: [...state.contacts, newItem] }));
+        return newItem;
+      } catch (error) {
+        console.error('Error adding contact:', error);
+        return null;
+      }
+    },
+
+    updateContact: async (item) => {
+      try {
+        set((state) => ({ contacts: state.contacts.map(n => n.id === item.id ? item : n) }));
+        if (!isNaN(Number(item.id))) {
+          const { updateContact: updateContactSP } = await import(/* webpackChunkName: 'sp-service' */ './services/SPService');
+          const spData = {
+            Title: item.fullName,
+            FirstName: item.firstName || '',
+            LastName: item.lastName || '',
+            Status: item.status,
+            SortOrder: item.sortOrder,
+            JobTitle: item.jobTitle || '',
+            Company: item.company || '',
+            Email: item.email || '',
+            Phone: item.phone || '',
+            Description: item.description,
+            Translations: JSON.stringify(item.translations || {}),
+            ImageUrl: { Url: item.imageUrl || '', Description: item.imageName || '' },
+            ImageName: item.imageName || ''
+          };
+          await updateContactSP(Number(item.id), spData);
+          console.log(`✅ Contact updated in SharePoint: ${item.id}`);
+        }
+      } catch (error) {
+        console.error('Error updating contact:', error);
+      }
+    },
+
+    deleteContact: async (id) => {
+      try {
+        if (!isNaN(Number(id))) {
+          const { deleteContact: deleteContactSP } = await import(/* webpackChunkName: 'sp-service' */ './services/SPService');
+          await deleteContactSP(Number(id));
+        }
+        set((state) => ({ contacts: state.contacts.filter(n => n.id !== id) }));
+
+        // Remove from all containers' taggedItems
+        get().removeItemFromContainers(id);
+      } catch (error) {
+        console.error('Error deleting contact:', error);
+      }
+    },
+
+    addImage: (item) => set((state) => {
+      const newImages = [...state.images, item];
+      return {
+        images: newImages,
+        imageFolders: recalculateFolderCounts(state.imageFolders, newImages)
+      };
+    }),
+
+    checkImageExists: async (fileName: string, folderId: string = '') => {
+      try {
+        const { checkImageExists } = await import(/* webpackChunkName: 'sp-service' */ './services/SPService');
+        return await checkImageExists(fileName, folderId);
+      } catch (error) {
+        console.error('Error checking image existence:', error);
+        return false;
+      }
+    },
+
+    uploadImage: async (file: File, folderId?: string, metadata?: any) => {
+      try {
+        const { uploadImage } = await import(/* webpackChunkName: 'sp-service' */ './services/SPService');
+        const result = await uploadImage(file, folderId, metadata);
+
+        if (result && result.item) {
+          const newItem: ImageItem = {
+            id: String(result.item.Id),
+            name: result.item.FileLeafRef,
+            url: result.item.FileRef,
+            folderId: folderId || 'all',
+            title: metadata?.Title || result.item.FileLeafRef,
+            description: metadata?.Description || '',
+            createdDate: result.item.Created || new Date().toISOString(),
+            modifiedDate: result.item.Modified || new Date().toISOString(),
+            createdBy: 'System'
+          };
+
+          set((state: AppState) => {
+            const newImages = [...state.images.filter(img => img.id !== newItem.id), newItem];
+            return {
+              images: newImages,
+              imageFolders: recalculateFolderCounts(state.imageFolders, newImages)
+            };
+          });
+          return newItem;
+        }
+        return null;
+      } catch (error) {
+        console.error('Error uploading image:', error);
+        return null;
+      }
+    },
+
+    updateImage: async (item: ImageItem) => {
+      try {
+        const { updateImage } = await import(/* webpackChunkName: 'sp-service' */ './services/SPService');
+
+        let fileToUpload: File | undefined;
+        if (item.url && item.url.startsWith('data:')) {
+          const response = await fetch(item.url);
+          const blob = await response.blob();
+          fileToUpload = new File([blob], item.name, { type: blob.type });
+        }
+
+        const updatedMetadata = {
+          Title: item.title,
+          Description: item.description,
+          AssetCategory: item.folderId !== 'all' ? item.folderId : undefined
+        };
+
+        const result = await updateImage(Number(item.id), fileToUpload, updatedMetadata);
+
+        const updatedItem: ImageItem = {
+          ...item,
+          id: String(result.Id),
+          name: result.FileLeafRef,
+          url: result.FileRef,
+          title: result.Title || result.FileLeafRef,
+          description: result.Description || '',
+          modifiedDate: result.Modified || new Date().toISOString()
+        };
+
+        set((state: AppState) => {
+          const newImages = state.images.map(i => i.id === updatedItem.id ? updatedItem : i);
+          return {
+            images: newImages,
+            imageFolders: recalculateFolderCounts(state.imageFolders, newImages)
+          };
+        });
+      } catch (error) {
+        console.error('Error updating image:', error);
+      }
+    },
+    deleteImage: async (id) => {
+      try {
+        const { deleteImage } = await import(/* webpackChunkName: 'sp-service' */ './services/SPService');
+        await deleteImage(Number(id));
+
+        set((state) => {
+          const newImages = state.images.filter(i => i.id !== id);
+          return {
+            images: newImages,
+            imageFolders: recalculateFolderCounts(state.imageFolders, newImages)
+          };
+        });
+      } catch (error) {
+        console.error('Error deleting image:', error);
+      }
+    },
+
+    updateTranslationItem: (id, sourceList, original, lang, value) => set((state) => {
+      const existingIndex = state.translationItems.findIndex(item => item.id === id);
+      if (existingIndex >= 0) {
+        const newItems = [...state.translationItems];
+        newItems[existingIndex] = {
+          ...newItems[existingIndex],
+          translations: { ...newItems[existingIndex].translations, [lang]: value },
+          lastUpdated: new Date().toISOString()
+        };
+        return { translationItems: newItems };
+      } else {
+        const newItem: TranslationItem = {
+          id,
+          sourceList,
+          original,
+          translations: { [lang]: value },
+          lastUpdated: new Date().toISOString()
+        };
+        return { translationItems: [...state.translationItems, newItem] };
+      }
+    }),
+
+    // Permission Actions
+    createPermissionGroup: (group) => set((state) => ({ permissionGroups: [...state.permissionGroups, group] })),
+    updatePermissionGroup: (group) => set((state) => ({ permissionGroups: state.permissionGroups.map(g => g.id === group.id ? group : g) })),
+    addMemberToGroup: (groupId: string, userId: string) => set((state) => ({
+      permissionGroups: state.permissionGroups.map(g => g.id === groupId ? { ...g, memberIds: [...g.memberIds, userId] } : g)
+    })),
+    removeMemberFromGroup: (groupId: string, userId: string) => set((state) => ({
+      permissionGroups: state.permissionGroups.map(g => g.id === groupId ? { ...g, memberIds: g.memberIds.filter(id => id !== userId) } : g)
+    })),
+
+    // Contact Query Actions
+    addContactQuery: async (query) => {
+      try {
+        // Add to local state immediately for responsiveness
+        set((state) => ({ contactQueries: [query, ...state.contactQueries] }));
+
+        // Save to SharePoint
+        const { saveContactQuery } = await import(/* webpackChunkName: 'sp-service' */ './services/SPService');
+        const spData = {
+          Title: query.email || 'Anonymous',
+          SourcePageId: query.pageId ? Number(query.pageId) : null,
+          QueryStatus: query.status,
+          FormData: JSON.stringify({
+            fields: query.fields,
+            firstName: query.firstName,
+            lastName: query.lastName,
+            email: query.email,
+            pageName: query.pageName,
+            containerId: query.containerId,
+            created: query.created
+          })
+        };
+        const result = await saveContactQuery(spData);
+        const realId = result.data ? result.data.Id : result.Id;
+
+        // Update with real SharePoint ID
+        set((state) => ({
+          contactQueries: state.contactQueries.map(q =>
+            q.id === query.id ? { ...q, id: String(realId) } : q
+          )
+        }));
+
+        console.log(`✅ Contact query saved to SharePoint with ID: ${realId}`);
+      } catch (error) {
+        console.error('Error saving contact query:', error);
+      }
+    },
+
+    deleteContactQuery: async (ids: string[]) => {
+      try {
+        // Delete from SharePoint
+        const { deleteContactQueries } = await import(/* webpackChunkName: 'sp-service' */ './services/SPService');
+        const numericIds = ids.filter(id => !isNaN(Number(id))).map(id => Number(id));
+        if (numericIds.length > 0) {
+          await deleteContactQueries(numericIds);
+        }
+
+        // Update local state
+        set((state) => ({ contactQueries: state.contactQueries.filter(q => !ids.includes(q.id)) }));
+        console.log(`✅ Deleted ${ids.length} contact queries`);
+      } catch (error) {
+        console.error('Error deleting contact queries:', error);
+      }
+    },
+
+    updateFooterConfig: (config) => set((state) => ({ siteConfig: { ...state.siteConfig, footer: { ...state.siteConfig.footer, ...config } } })),
+
+    openLabelEditor: (key) => set({ activeModal: ModalType.LABEL_EDITOR, editingLabelKey: key }),
+    updateLabel: (key, text, lang) => set((state) => ({ uiLabels: { ...state.uiLabels, [key]: { ...state.uiLabels[key], [lang]: text } }, activeModal: ModalType.NONE, editingLabelKey: null })),
+
+    addPage: async (page) => {
+      try {
+        // 1. Save Page to SharePoint
+        const { savePage, saveContainer } = await import(/* webpackChunkName: 'sp-service' */ './services/SPService');
+        const spPageData = {
+          Title: page.title.en,
+          MultilingualTitle: JSON.stringify(page.title),
+          Slug: page.slug,
+          PageStatus: page.status,
+          IsHomePage: page.isHomePage,
+          Description: page.description,
+          SEOConfig: JSON.stringify(page.seo || {}),
+          VersionNote: 'Initial Creation'
+        };
+
+        const savedPage = await savePage(spPageData);
+        // PnPjs returns { data: { Id: ... } }
+        const realPageId = String(savedPage.Id);
+
+        // 2. Assign Real ID to Containers & Save Them
+        const containersToSave = page.containers && page.containers.length > 0
+          ? page.containers
+          : [];
+
+        const savedContainersWithIds: Container[] = [];
+
+        for (const container of containersToSave) {
+          const spContainerData = {
+            PageId: Number(realPageId),
+            ContainerType: container.type,
+            SortOrder: container.order,
+            Settings: JSON.stringify(container.settings || {}),
+            ContainerContent: JSON.stringify(container.content || {}),
+            IsVisible: container.isVisible,
+            Title: container.title || container.settings?.containerTitle || container.settings?.title || container.type
+          };
+          const savedContainer = await saveContainer(spContainerData);
+          savedContainersWithIds.push({ ...container, id: String(savedContainer.data.Id), pageId: realPageId });
+        }
+
+        // 3. Update Local Store with Fully Populated Page
+        const newPage: Page = {
+          ...page,
+          id: realPageId,
+          title: page.title, // Keep full object
+          containers: savedContainersWithIds,
+          modifiedDate: savedPage.Modified || new Date().toISOString()
+        };
+
+        set((state) => ({ pages: [...state.pages, newPage] }));
+        console.log(`✅ Page created with ID: ${realPageId}`);
+        return newPage;
+
+      } catch (error) {
+        console.error('Error adding page:', error);
+        return null;
+      }
+    },
+
+    updatePage: async (page) => {
+      try {
+        const { updatePage: updatePageSP } = await import(/* webpackChunkName: 'sp-service' */ './services/SPService');
+        const spData = {
+          Title: page.title.en,
+          MultilingualTitle: JSON.stringify(page.title),
+          Slug: page.slug,
+          PageStatus: page.status,
+          IsHomePage: page.isHomePage,
+          Description: page.description,
+          SEOConfig: JSON.stringify(page.seo || {})
+        };
+        await updatePageSP(Number(page.id), spData);
+        set((state) => ({ pages: state.pages.map(p => p.id === page.id ? page : p) }));
+      } catch (error) {
+        console.error('Error updating page:', error);
+      }
+    },
+
+    deletePage: async (id) => {
+      try {
+        const { deletePage: deletePageSP } = await import(/* webpackChunkName: 'sp-service' */ './services/SPService');
+        await deletePageSP(Number(id));
+        // Also remove containers locally (SP cascade delete not assumed, but keeping store clean)
+        set((state) => ({ pages: state.pages.filter(p => p.id !== id) }));
+      } catch (error) {
+        console.error('Error deleting page:', error);
+      }
+    },
+    addContainer: async (pageId, container) => {
+      try {
+        console.log('📦 Adding container with settings:', container.settings);
+
+        // Process settings to upload any external image URLs to SharePoint
+        const processedSettings = { ...container.settings };
+
+        // Check if container has a background image URL
+        if (processedSettings.bgImage && typeof processedSettings.bgImage === 'string' && processedSettings.bgImage.trim() !== '') {
+          console.log(`🔍 Found bgImage URL: ${processedSettings.bgImage}`);
+
+          // Import the uploadImageFromUrl function
+          const { uploadImageFromUrl } = await import(/* webpackChunkName: 'sp-service' */ './services/SPService');
+
+          // Upload the image and get the SharePoint URL
+          const sharePointUrl = await uploadImageFromUrl(
+            processedSettings.bgImage,
+            'Containers',
+            {
+              Title: container.title || container.content?.title?.en || 'Container Background',
+              Description: `Background image for container ${container.type}`,
+              AltText: 'Container background image'
+            }
+          );
+
+          // Update the settings with the SharePoint URL
+          if (sharePointUrl) {
+            processedSettings.bgImage = sharePointUrl;
+            console.log(`✅ Updated bgImage to SharePoint URL: ${sharePointUrl}`);
+          }
+        }
+
+        const { saveContainer } = await import(/* webpackChunkName: 'sp-service' */ './services/SPService');
+        const spData = {
+          PageId: Number(pageId),
+          ContainerType: container.type,
+          SortOrder: container.order,
+          Settings: JSON.stringify(processedSettings),
+          ContainerContent: JSON.stringify(container.content || {}),
+          IsVisible: container.isVisible,
+          Title: container.title || container.settings?.containerTitle || container.settings?.title || container.type
+        };
+        const savedItem = await saveContainer(spData);
+        // PnPjs returns { data: { Id: ... } }
+        const newContainer = {
+          ...container,
+          id: String(savedItem.Id),
+          pageId,
+          settings: processedSettings // Use processed settings with SharePoint URLs
+        };
+        set((state) => ({ pages: state.pages.map(p => p.id === pageId ? { ...p, containers: [...p.containers, newContainer] } : p) }));
+        return newContainer;
+      } catch (error) {
+        console.error('Error adding container:', error);
+        return null;
+      }
+    },
+
+    updateContainer: async (pageId, container) => {
+      try {
+        console.log('🔄 Updating container with settings:', container.settings);
+
+        // Process settings to upload any external image URLs to SharePoint
+        const processedSettings = { ...container.settings };
+
+        // Check if container has a background image URL that isn't already from SharePoint
+        if (processedSettings.bgImage && typeof processedSettings.bgImage === 'string' && processedSettings.bgImage.trim() !== '') {
+          console.log(`🔍 Found bgImage URL: ${processedSettings.bgImage}`);
+
+          // Import the uploadImageFromUrl function
+          const { uploadImageFromUrl } = await import(/* webpackChunkName: 'sp-service' */ './services/SPService');
+
+          // Upload the image and get the SharePoint URL (will skip if already SharePoint URL)
+          const sharePointUrl = await uploadImageFromUrl(
+            processedSettings.bgImage,
+            'Containers',
+            {
+              Title: container.title || container.content?.title?.en || 'Container Background',
+              Description: `Background image for container ${container.type}`,
+              AltText: 'Container background image'
+            }
+          );
+
+          // Update the settings with the SharePoint URL
+          if (sharePointUrl) {
+            processedSettings.bgImage = sharePointUrl;
+            console.log(`✅ Updated bgImage to SharePoint URL: ${sharePointUrl}`);
+          }
+        }
+
+        const { updateContainer: updateContainerSP } = await import(/* webpackChunkName: 'sp-service' */ './services/SPService');
+        const spData = {
+          PageId: Number(pageId),
+          ContainerType: container.type,
+          SortOrder: container.order,
+          Settings: JSON.stringify(processedSettings),
+          ContainerContent: JSON.stringify(container.content || {}),
+          IsVisible: container.isVisible,
+          Title: container.title || container.settings?.containerTitle || container.settings?.title || container.type
+        };
+        await updateContainerSP(Number(container.id), spData);
+
+        // Update local state with processed settings
+        const updatedContainer = { ...container, settings: processedSettings };
+        set((state) => ({ pages: state.pages.map(p => p.id === pageId ? { ...p, containers: p.containers.map(c => c.id === container.id ? updatedContainer : c) } : p) }));
+      } catch (error) {
+        console.error('Error updating container:', error);
+      }
+    },
+
+    deleteContainer: async (pageId, cId) => {
+      try {
+        const { deleteContainer: deleteContainerSP } = await import(/* webpackChunkName: 'sp-service' */ './services/SPService');
+        await deleteContainerSP(Number(cId));
+        set((state) => ({ pages: state.pages.map(p => p.id === pageId ? { ...p, containers: p.containers.filter(c => c.id !== cId) } : p) }));
+      } catch (error) {
+        console.error('Error deleting container:', error);
+      }
+    },
+    reorderContainers: (pageId, newOrder) => set((state) => ({ pages: state.pages.map(p => p.id === pageId ? { ...p, containers: newOrder } : p) })),
+
+    // SharePoint Data Loading Actions
+    saveGlobalSettings: async (type) => {
+      try {
+        const { upsertGlobalSetting } = await import(/* webpackChunkName: 'sp-service' */ './services/SPService');
+        const state = get();
+        let key = '';
+        let data = '';
+
+        if (type === 'theme') {
+          key = 'THEME_CONFIG';
+          data = JSON.stringify(state.themeConfig);
+        } else if (type === 'site') {
+          key = 'SITE_CONFIG';
+          // Exclude navigation from config blob to avoid redundancy
+          const { navigation: _navigation, ...configToSave } = state.siteConfig;
+          data = JSON.stringify(configToSave);
+        } else if (type === 'labels') {
+          key = 'UI_LABELS';
+          data = JSON.stringify(state.uiLabels);
+        } else if (type === 'app') {
+          key = 'APP_STATE';
+          data = JSON.stringify({
+            currentPageId: state.currentPageId,
+            currentLanguage: state.currentLanguage,
+            editingContainerId: state.editingContainerId
+          });
+        }
+
+        if (key && data) {
+          await upsertGlobalSetting(key, { ConfigData: data });
+          console.log(`✅ Saved ${type} settings to SharePoint`);
+        }
+      } catch (error) {
+        console.error(`❌ Error saving ${type} settings:`, error);
+      }
+    },
+
+    syncTranslations: async () => {
+      try {
+        const { upsertTranslation } = await import(/* webpackChunkName: 'sp-service' */ './services/SPService');
+        const state = get();
+
+        for (const item of state.translationItems) {
+          await upsertTranslation(item.id, item.translations, item.sourceList);
+        }
+        console.log('✅ Translations synced to SharePoint');
+      } catch (error) {
+        console.error('❌ Error syncing translations:', error);
+      }
+    },
+
+    setLoading: (loading: boolean) => set({ isLoading: loading }),
+
+    loadFromSharePoint: async () => {
+      try {
+        set({ isLoading: true });
+        console.log('🔄 Loading data from SharePoint...');
+
+        // Dynamically import SP service functions
+        const {
+          getPages,
+          getContainersByPageId,
+          getNavigation,
+          getNews,
+          getEvents,
+          getDocuments,
+          getImages,
+          getFolders,
+          getGlobalSettings,
+          getTranslations,
+          getContainerItems,
+          getContactQueries,
+          getContacts
+        } = await import(/* webpackChunkName: 'sp-service' */ './services/SPService');
+
+        // Load all data in parallel
+        const [spPages, spNav, spNews, spEvents, spDocs, spSettings, spTranslations, spContainerItems, spContactQueries, spContacts] = await Promise.all([
+          getPages().catch(err => { console.error('Error loading pages:', err); return []; }),
+          getNavigation().catch(err => { console.error('Error loading nav:', err); return []; }),
+          getNews().catch(err => { console.error('Error loading news:', err); return []; }),
+          getEvents().catch(err => { console.error('Error loading events:', err); return []; }),
+          getDocuments().catch(err => { console.error('Error loading documents:', err); return []; }),
+          getGlobalSettings().catch(err => { console.error('Error loading settings:', err); return []; }),
+          getTranslations().catch(err => { console.error('Error loading translations:', err); return []; }),
+          getContainerItems().catch(err => { console.error('Error loading container items:', err); return []; }),
+          getContactQueries().catch(err => { console.error('Error loading contact queries:', err); return []; }),
+          getContacts().catch(err => { console.error('Error loading contacts:', err); return []; })
+        ]);
+
+        console.log('📊 SharePoint Data Loaded:', { spPages, spNav, spNews, spDocs, spSettings, spTranslations, spContainerItems, spContactQueries });
+
+        // --- Process Global Settings ---
+        let loadedTheme = DEFAULT_THEME;
+        let loadedSiteConfig = get().siteConfig;
+        let loadedUiLabels = INITIAL_UI_LABELS;
+
+        if (spSettings.length > 0) {
+          const themeItem = spSettings.find((i: any) => i.Title === 'THEME_CONFIG');
+          if (themeItem && themeItem.ConfigData) {
+            try {
+              const parsedTheme = JSON.parse(themeItem.ConfigData);
+              loadedTheme = { ...DEFAULT_THEME, ...parsedTheme };
+            } catch (e) {
+              console.error('Error parsing theme config:', e);
+            }
+          }
+
+          const siteItem = spSettings.find((i: any) => i.Title === 'SITE_CONFIG');
+          if (siteItem && siteItem.ConfigData) {
+            try {
+              const parsedSite = JSON.parse(siteItem.ConfigData);
+              // Merge with existing structure to ensure no missing keys
+              loadedSiteConfig = { ...loadedSiteConfig, ...parsedSite };
+            } catch (e) {
+              console.error('Error parsing site config:', e);
+            }
+          }
+
+          const labelsItem = spSettings.find((i: any) => i.Title === 'UI_LABELS');
+          if (labelsItem && labelsItem.ConfigData) {
+            try {
+              const parsedLabels = JSON.parse(labelsItem.ConfigData);
+              loadedUiLabels = { ...loadedUiLabels, ...parsedLabels };
+            } catch (e) {
+              console.error('Error parsing UI labels:', e);
+            }
+          }
+
+          const appItem = spSettings.find((i: any) => i.Title === 'APP_STATE');
+          if (appItem && appItem.ConfigData) {
+            try {
+              const parsedApp = JSON.parse(appItem.ConfigData);
+              if (parsedApp.currentPageId) set({ currentPageId: parsedApp.currentPageId });
+              if (parsedApp.currentLanguage) set({ currentLanguage: parsedApp.currentLanguage });
+              if (parsedApp.editingContainerId) set({ editingContainerId: parsedApp.editingContainerId });
+            } catch (e) {
+              console.error('Error parsing APP state:', e);
+            }
+          }
+
+          const sourcesItem = spSettings.find((i: any) => i.Title === 'TRANSLATION_SOURCES');
+          if (sourcesItem && sourcesItem.ConfigData) {
+            try {
+              const parsedSources = JSON.parse(sourcesItem.ConfigData);
+              if (Array.isArray(parsedSources)) set({ translationSources: parsedSources });
+            } catch (e) {
+              console.error('Error parsing TRANSLATION_SOURCES:', e);
+            }
+          }
+        }
+
+        // --- Process Translations from List ---
+        if (spTranslations && spTranslations.length > 0) {
+          spTranslations.forEach((t: any) => {
+            if (t.Title) {
+              loadedUiLabels[t.Title] = {
+                en: t.EN || loadedUiLabels[t.Title]?.en || '',
+                de: t.DE || loadedUiLabels[t.Title]?.de || '',
+                fr: t.FR || loadedUiLabels[t.Title]?.fr || '',
+                es: t.ES || loadedUiLabels[t.Title]?.es || ''
+              };
+            }
+          });
+        }
+
+        // Transform for the Dictionary View state
+        const loadedTranslationItems: TranslationItem[] = spTranslations && spTranslations.length > 0
+          ? spTranslations.map((t: any) => ({
+            id: t.Title,
+            sourceList: t.SourceList || 'General',
+            original: t.Title,
+            translations: {
+              en: t.EN || '',
+              de: t.DE || '',
+              fr: t.FR || '',
+              es: t.ES || ''
+            },
+            lastUpdated: new Date().toISOString()
+          }))
+          : Object.keys(loadedUiLabels).map(key => ({
+            id: key,
+            sourceList: 'TranslationDictionary',
+            original: key,
+            translations: loadedUiLabels[key],
+            lastUpdated: new Date().toISOString()
+          }));
+
+        // Transform SharePoint data to store format
+        const transformedPages: Page[] = await Promise.all(
+          spPages.map(async (spPage: any) => {
+            // Load containers for this page
+            const spContainers = await getContainersByPageId(spPage.Id).catch(() => []);
+
+            return {
+              id: String(spPage.Id),
+              title: spPage.MultilingualTitle ? JSON.parse(spPage.MultilingualTitle) : { en: spPage.Title },
+              slug: spPage.Slug || '/',
+              status: spPage.PageStatus || 'Draft',
+              createdBy: spPage.Author?.Title || 'System',
+              modifiedBy: spPage.Editor?.Title || 'System',
+              modifiedDate: spPage.Modified || new Date().toISOString(),
+              description: unescapeHtml(spPage.Description || ''),
+              isHomePage: spPage.IsHomePage || false,
+              seo: spPage.SEOConfig ? JSON.parse(spPage.SEOConfig) : undefined,
+              containers: spContainers.map((c: any) => ({
+                id: String(c.Id),
+                pageId: c.Page?.Id ? String(c.Page.Id) : '',
+                type: c.ContainerType,
+                order: c.SortOrder || 0,
+                isVisible: c.IsVisible !== false,
+                settings: c.Settings ? JSON.parse(c.Settings) : {},
+                content: c.ContainerContent ? ((): any => {
+                  const parsed = JSON.parse(c.ContainerContent);
+                  // Unescape description in translations if present
+                  if (parsed.translations) {
+                    Object.keys(parsed.translations).forEach(lang => {
+                      if (parsed.translations[lang].description) {
+                        parsed.translations[lang].description = unescapeHtml(parsed.translations[lang].description);
+                      }
+                    });
+                  }
+                  return parsed;
+                })() : {},
+                title: c.Title || ''
+              }))
+            };
+          })
+        );
+
+        const transformedNav: NavItem[] = spNav.map((item: any) => ({
+          id: String(item.Id),
+          parentId: item.Parent?.Id ? String(item.Parent.Id) : 'root',
+          title: item.Title,
+          type: item.NavType || 'Page',
+          pageId: item.SmartPage?.Id ? String(item.SmartPage.Id) : undefined,
+          url: item.ExternalURL,
+          isVisible: item.IsVisible !== false,
+          openInNewTab: item.OpenInNewTab || false,
+          order: item.SortOrder || 0,
+          translations: item.Translations ? JSON.parse(item.Translations) : {},
+          modified: item.Modified
+        }));
+
+        const transformedNews: NewsItem[] = spNews.map((item: any) => ({
+          id: String(item.Id),
+          title: item.Title,
+          status: item.Status || 'Draft',
+          publishDate: item.PublishDate || new Date().toISOString(),
+          description: unescapeHtml(item.Description || ''),
+          imageUrl: item.ImageUrl?.Url || '',
+          imageName: item.ImageName || '',
+          readMore: {
+            enabled: item.ReadMoreEnabled || false,
+            text: item.ReadMoreText || '',
+            url: item.ReadMoreURL || ''
+          },
+          seo: item.SEOConfig ? JSON.parse(item.SEOConfig) : { title: '', description: '', keywords: '' },
+          translations: item.Translations ? ((): any => {
+            const parsed = JSON.parse(item.Translations);
+            Object.keys(parsed).forEach(lang => {
+              if (parsed[lang].description) {
+                parsed[lang].description = unescapeHtml(parsed[lang].description);
+              }
+            });
+            return parsed;
+          })() : {},
+          createdBy: item.Author?.Title || 'System',
+          modifiedBy: item.Editor?.Title || 'System',
+          createdDate: item.Created,
+          modifiedDate: item.Modified || item.Created
+        }));
+
+        const transformedEvents: EventItem[] = spEvents.map((item: any) => ({
+          id: String(item.Id),
+          title: item.Title,
+          status: item.Status || 'Draft',
+          startDate: item.StartDate || new Date().toISOString(),
+          endDate: item.EndDate || '',
+          location: item.Location || '',
+          description: unescapeHtml(item.Description || ''),
+          category: item.Category || 'General',
+          imageUrl: item.ImageUrl?.Url || '',
+          imageName: item.ImageName || '',
+          readMore: {
+            enabled: item.ReadMoreEnabled || false,
+            text: item.ReadMoreText || '',
+            url: item.ReadMoreURL || ''
+          },
+          seo: item.SEOConfig ? JSON.parse(item.SEOConfig) : { title: '', description: '', keywords: '' },
+          translations: item.Translations ? ((): any => {
+            const parsed = JSON.parse(item.Translations);
+            Object.keys(parsed).forEach(lang => {
+              if (parsed[lang].description) {
+                parsed[lang].description = unescapeHtml(parsed[lang].description);
+              }
+            });
+            return parsed;
+          })() : {},
+          createdBy: item.Author?.Title || 'System',
+          modifiedBy: item.Editor?.Title || 'System',
+          createdDate: item.Created,
+          modifiedDate: item.Modified || item.Created
+        }));
+
+        const transformedDocs: DocumentItem[] = spDocs.map((item: any) => ({
+          id: String(item.Id),
+          title: item.Title,
+          name: item.Name, // File name (FileLeafRef)
+          status: item.DocStatus || 'Draft',
+          date: item.Modified || new Date().toISOString(),
+          type: item.DocType || 'PDF',
+          year: item.DocumentYear || new Date().getFullYear().toString(),
+          description: unescapeHtml(item.DocumentDescriptions || ''),
+          itemRank: item.ItemRank || 5,
+          sortOrder: item.SortOrder || 0,
+          url: item.FileRef,
+          imageUrl: item.ImageUrl || '',
+          imageName: item.ImageName || '',
+          translations: item.Translations ? ((): any => {
+            const parsed = JSON.parse(item.Translations);
+            Object.keys(parsed).forEach(lang => {
+              if (parsed[lang].description) {
+                parsed[lang].description = unescapeHtml(parsed[lang].description);
+              }
+            });
+            return parsed;
+          })() : {},
+          createdBy: item.AuthorName || 'System',
+          modifiedBy: item.EditorName || 'System',
+          createdDate: item.Created,
+          modifiedDate: item.Modified || item.Created
+        }));
+
+        // --- IMAGES ---
+        // Fetch Folders first, then Images
+        let transformedImages: ImageItem[] = [];
+        let imageFolders: ImageFolder[] = [];
+        try {
+          const folders = await getFolders();
+          const images = await getImages(folders);
+
+          // Transform folders to ImageFolder type
+          imageFolders = [
+            { id: 'all', name: 'All Images', count: images.length },
+            ...folders.map(f => ({
+              id: f.id,
+              name: f.name,
+              count: images.filter(i => String(i.AssetCategory).toLowerCase() === String(f.id).toLowerCase()).length
+            }))
+          ];
+
+          transformedImages = images.map((img: any) => ({
+            id: String(img.Id),
+            name: img.FileName,
+            url: img.ImageUrl,
+            folderId: img.AssetCategory || 'all',
+            title: img.Title || img.FileName,
+            description: img.Description || '',
+            copyright: img.CopyrightInfo || '',
+            createdDate: img.Created,
+            createdBy: img.AuthorName || 'Unknown'
+          }));
+
+        } catch (e) { console.error('Error loading images/folders', e); }
+
+        const transformedContainerItems: ContainerItem[] = spContainerItems.map((item: any) => ({
+          id: String(item.Id),
+          title: item.Title,
+          status: item.Status || 'Draft',
+          sortOrder: item.SortOrder || 0,
+          description: unescapeHtml(item.Description || ''),
+          imageUrl: item.ImageUrl?.Url || '',
+          imageName: item.ImageName || '',
+          translations: item.Translations ? ((): any => {
+            const parsed = JSON.parse(item.Translations);
+            Object.keys(parsed).forEach(lang => {
+              if (parsed[lang].description) {
+                parsed[lang].description = unescapeHtml(parsed[lang].description);
+              }
+            });
+            return parsed;
+          })() : {},
+          createdBy: item.Author?.Title || 'System',
+          modifiedBy: item.Editor?.Title || 'System',
+          createdDate: item.Created,
+          modifiedDate: item.Modified || item.Created
+        }));
+
+        // --- CONTACTS ---
+        const transformedContacts: ContactItem[] = spContacts.map((item: any) => ({
+          id: String(item.Id),
+          fullName: item.Title || '',
+          firstName: item.FirstName || '',
+          lastName: item.LastName || '',
+          status: item.Status || 'Draft',
+          sortOrder: item.SortOrder || 0,
+          jobTitle: item.JobTitle || '',
+          company: item.Company || '',
+          email: item.Email || '',
+          phone: item.Phone || '',
+          description: unescapeHtml(item.Description || ''),
+          imageUrl: item.ImageUrl?.Url || '',
+          imageName: item.ImageName || '',
+          translations: item.Translations ? ((): any => {
+            const parsed = JSON.parse(item.Translations);
+            Object.keys(parsed).forEach(lang => {
+              if (parsed[lang].description) {
+                parsed[lang].description = unescapeHtml(parsed[lang].description);
+              }
+            });
+            return parsed;
+          })() : {},
+          createdBy: item.Author?.Title || 'System',
+          modifiedBy: item.Editor?.Title || 'System',
+          createdDate: item.Created,
+          modifiedDate: item.Modified || item.Created
+        }));
+
+        // --- CONTACT QUERIES ---
+        const transformedContactQueries: ContactQuery[] = spContactQueries.map((item: any) => {
+          let formData: any = {};
+          try {
+            formData = item.FormData ? JSON.parse(item.FormData) : {};
+          } catch (e) {
+            console.error('Error parsing FormData for contact query:', e);
+          }
+
+          return {
+            id: String(item.Id),
+            pageId: item.SourcePage?.Id ? String(item.SourcePage.Id) : formData.pageId || '',
+            pageName: item.SourcePage?.Title || formData.pageName || 'Unknown Page',
+            containerId: formData.containerId || '',
+            created: item.Created || formData.created || new Date().toISOString(),
+            status: item.QueryStatus || 'New',
+            email: formData.email || item.Title || 'Anonymous',
+            firstName: formData.firstName,
+            lastName: formData.lastName,
+            smartPage: formData.pageName,
+            fields: formData.fields || []
+          };
+        });
+
+        // Update store with SharePoint data (fallback to mock if empty)
+        // Update store with SharePoint data (No Mock Fallbacks)
+        // --- Navigation Logic to Set Default Page ---
+        // 1. Find "HOME" in Navigation (Case Insensitive)
+        let defaultPageId = '';
+        const homeNavItem = transformedNav.find(n => n.title.toUpperCase() === 'HOME' && n.pageId);
+
+        if (homeNavItem && homeNavItem.pageId) {
+          defaultPageId = homeNavItem.pageId;
+        } else {
+          // 2. Fallback: Run "any" navigation.
+          // We prioritize ROOT items to match the user's likely expectation (Top/First Sidebar Item)
+          const rootItems = transformedNav.filter(n => n.parentId === 'root').sort((a, b) => a.order - b.order);
+          const firstRootPage = rootItems.find(n => n.type === 'Page' && n.pageId);
+
+          if (firstRootPage && firstRootPage.pageId) {
+            defaultPageId = firstRootPage.pageId;
+          } else {
+            // If no root pages, try ANY page in navigation (sorted by order)
+            const sortedNav = [...transformedNav].sort((a, b) => a.order - b.order);
+            const firstPageNav = sortedNav.find(n => n.type === 'Page' && n.pageId);
+
+            if (firstPageNav && firstPageNav.pageId) {
+              defaultPageId = firstPageNav.pageId;
+            } else if (transformedPages.length > 0) {
+              // Fallback: First generic page (no nav item)
+              defaultPageId = transformedPages[0].id;
+            }
+          }
+        }
+
+        // Verify the page actually exists in our loaded pages
+        const defaultPageExists = transformedPages.find(p => p.id === defaultPageId);
+        if (!defaultPageExists && transformedPages.length > 0) {
+          defaultPageId = transformedPages[0].id;
+        }
+
+        // If no hash is set (root), or if we want to enforce the default logic
+        // construct the correct slug for the determined default page
+        if (defaultPageExists) {
+          const targetSlug = defaultPageExists.slug;
+          // Only redirect if at root or if necessary. 
+          // If the user already has a hash, App.tsx will likely handle it. 
+          // However, if the current hash is invalid or just empty, we set this.
+          if (!window.location.hash || window.location.hash === '#/' || window.location.hash === '#') {
+            window.location.hash = targetSlug;
+          }
+        }
+
+        set({
+          pages: transformedPages,
+          news: transformedNews,
+          events: transformedEvents,
+          documents: transformedDocs,
+          containerItems: transformedContainerItems,
+          contacts: transformedContacts,
+          contactQueries: transformedContactQueries,
+          images: transformedImages,
+          imageFolders: imageFolders,
+          siteConfig: {
+            ...loadedSiteConfig,
+            navigation: transformedNav
+          },
+          themeConfig: loadedTheme,
+          uiLabels: loadedUiLabels,
+          translationItems: loadedTranslationItems,
+          currentPageId: defaultPageId || '1', // Ensure valid ID
+          isLoading: false
+        });
+
+        console.log('✅ SharePoint data loaded successfully');
+
+        // Validate and clean up invalid taggedItems references
+        await get().validateContainerTaggedItems();
+      } catch (error) {
+        console.error('❌ Error loading SharePoint data:', error);
+        set({ isLoading: false });
+      }
+    },
+
+    // Helper function to remove a deleted item from all containers' taggedItems
+    removeItemFromContainers: async (itemId: string) => {
+      try {
+        const state = get();
+        let hasChanges = false;
+
+        const updatedPages = state.pages.map(page => {
+          const updatedContainers = page.containers.map(container => {
+            const taggedItems = container.settings?.taggedItems;
+            if (taggedItems && Array.isArray(taggedItems) && taggedItems.includes(itemId)) {
+              hasChanges = true;
+              const newTaggedItems = taggedItems.filter((id: string) => id !== itemId);
+              console.log(`🧹 Removing item ${itemId} from container ${container.id} in page ${page.id}`);
+              return {
+                ...container,
+                settings: {
+                  ...container.settings,
+                  taggedItems: newTaggedItems
+                }
+              };
+            }
+            return container;
+          });
+
+          if (updatedContainers.some((c, i) => c !== page.containers[i])) {
+            return { ...page, containers: updatedContainers };
+          }
+          return page;
+        });
+
+        if (hasChanges) {
+          set({ pages: updatedPages });
+
+          // Update SharePoint for each modified container
+          const { updateContainer: updateContainerSP } = await import(/* webpackChunkName: 'sp-service' */ './services/SPService');
+          for (const page of updatedPages) {
+            for (const container of page.containers) {
+              const originalContainer = state.pages
+                .find(p => p.id === page.id)
+                ?.containers.find(c => c.id === container.id);
+
+              if (originalContainer && originalContainer.settings?.taggedItems !== container.settings?.taggedItems) {
+                const spData = {
+                  PageId: Number(page.id),
+                  ContainerType: container.type,
+                  SortOrder: container.order,
+                  Settings: JSON.stringify(container.settings || {}),
+                  ContainerContent: JSON.stringify(container.content || {}),
+                  IsVisible: container.isVisible,
+                  Title: container.title || container.settings?.containerTitle || container.settings?.title || container.type
+                };
+                await updateContainerSP(Number(container.id), spData);
+                console.log(`✅ Updated container ${container.id} in SharePoint`);
+              }
+            }
+          }
+        }
+      } catch (error) {
+        console.error('Error removing item from containers:', error);
+      }
+    },
+
+    // Helper function to validate and clean up invalid taggedItems on load
+    validateContainerTaggedItems: async () => {
+      try {
+        const state = get();
+        const allItemIds = new Set([
+          ...state.news.map(n => n.id),
+          ...state.events.map(e => e.id),
+          ...state.documents.map(d => d.id),
+          ...state.containerItems.map(c => c.id),
+          ...state.pages.map(p => p.id)
+        ]);
+
+        let hasChanges = false;
+
+        const updatedPages = state.pages.map(page => {
+          const updatedContainers = page.containers.map(container => {
+            const taggedItems = container.settings?.taggedItems;
+            if (taggedItems && Array.isArray(taggedItems)) {
+              const validTaggedItems = taggedItems.filter((id: string) => allItemIds.has(id));
+
+              if (validTaggedItems.length !== taggedItems.length) {
+                hasChanges = true;
+                const removedIds = taggedItems.filter((id: string) => !allItemIds.has(id));
+                console.log(`🧹 Cleaning invalid IDs from container ${container.id}: ${removedIds.join(', ')}`);
+
+                return {
+                  ...container,
+                  settings: {
+                    ...container.settings,
+                    taggedItems: validTaggedItems
+                  }
+                };
+              }
+            }
+            return container;
+          });
+
+          if (updatedContainers.some((c, i) => c !== page.containers[i])) {
+            return { ...page, containers: updatedContainers };
+          }
+          return page;
+        });
+
+        if (hasChanges) {
+          set({ pages: updatedPages });
+
+          // Update SharePoint for each modified container
+          const { updateContainer: updateContainerSP } = await import(/* webpackChunkName: 'sp-service' */ './services/SPService');
+          for (const page of updatedPages) {
+            for (const container of page.containers) {
+              const originalContainer = state.pages
+                .find(p => p.id === page.id)
+                ?.containers.find(c => c.id === container.id);
+
+              if (originalContainer && originalContainer.settings?.taggedItems !== container.settings?.taggedItems) {
+                const spData = {
+                  PageId: Number(page.id),
+                  ContainerType: container.type,
+                  SortOrder: container.order,
+                  Settings: JSON.stringify(container.settings || {}),
+                  ContainerContent: JSON.stringify(container.content || {}),
+                  IsVisible: container.isVisible,
+                  Title: container.title || container.settings?.containerTitle || container.settings?.title || container.type
+                };
+                await updateContainerSP(Number(container.id), spData);
+                console.log(`✅ Validated and updated container ${container.id} in SharePoint`);
+              }
+            }
+          }
+
+          console.log('✅ Container taggedItems validation completed');
+        }
+      } catch (error) {
+        console.error('Error validating container taggedItems:', error);
+      }
+    },
+  })
 );
 
 export const getTranslation = (key: string, lang: LanguageCode): string => {
-  const item = INITIAL_UI_LABELS[key];
+  const uiLabels = useStore.getState().uiLabels;
+  const item = uiLabels[key] || INITIAL_UI_LABELS[key];
   if (!item) return key;
-  return item[lang] || item['en'];
+  return item[lang] || item.en || key;
 };
 
 export const getLocalizedText = (text: MultilingualText | string, lang: LanguageCode): string => {
   if (typeof text === 'string') return text;
   if (!text) return '';
-  return text[lang] || text['en'] || '';
+  return text[lang] || text.en || '';
 };
+
+export const getItemTranslation = (item: any, lang: LanguageCode, field: string): string => {
+  if (!item) return '';
+
+  // Check specific language
+  if (item.translations && item.translations[lang]) {
+    if (typeof item.translations[lang] === 'string' && field === 'title') {
+      return item.translations[lang];
+    }
+    if (item.translations[lang][field]) {
+      return item.translations[lang][field];
+    }
+  }
+
+  // Fallback to English translation
+  if (item.translations && item.translations['en']) {
+    if (typeof item.translations['en'] === 'string' && field === 'title') {
+      return item.translations['en'];
+    }
+    if (item.translations['en'][field]) {
+      return item.translations['en'][field];
+    }
+  }
+
+  return item[field] || '';
+};
+
+export const getGlobalTranslation = (id: string, translationItems: any[], lang: LanguageCode, fallback: string): string => {
+  const item = translationItems?.find(t => t.id === id);
+  if (!item) return fallback;
+  return item.translations[lang] || item.translations.en || fallback;
+};
